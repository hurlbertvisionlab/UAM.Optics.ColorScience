//
// © 2016-2021 miloush.net. All rights reserved.
//

namespace UAM.Optics.ColorScience
{
    using System;
    using System.Collections.Generic;

    /// <summary>
    /// The colour matching functions are obtained from a series of matches in which the subject sets the intensities of the three colours required to match a series of monochromatic (single wavelength) lights of equal energy that traverse the visible spectrum. 
    /// </summary>
    public static class ColorMatchingFunctions
    {
        // this probably needs redesign
        // and also alow easy inline multiplications with the results

        public abstract class XYZ : IEnumerable<KeyValuePair<int, Color1931XYZ>>
        {
            public abstract int FirstNanometers { get; }
            public abstract int LastNanometers { get; }
            public abstract int StepNanometers { get; }

            protected abstract float[] SamplesX { get; }
            protected abstract float[] SamplesY { get; }
            protected abstract float[] SamplesZ { get; }

            public bool GetValuesAt(int nm, out float x̄, out float ȳ, out float z̄)
            {
                if (nm < FirstNanometers || nm > LastNanometers) // no linear interpolation to zereos
                {
                    x̄ = ȳ = z̄ = 0;
                    return false;
                }

                int i = (nm - FirstNanometers) / StepNanometers;
                x̄ = SamplesX[i];
                ȳ = SamplesY[i];
                z̄ = SamplesZ[i];

                int m = nm % StepNanometers;
                if (m == 0)
                    return true;

                i++;
                float highX = SamplesX[i];
                float highY = SamplesY[i];
                float highZ = SamplesZ[i];

                float w = (1f / StepNanometers) * m;

                x̄ = (1f - w) * x̄ + w * highX;
                ȳ = (1f - w) * ȳ + w * highY;
                z̄ = (1f - w) * z̄ + w * highZ;
                return true;
            }
            public bool GetValuesAt(float nm, out float x̄, out float ȳ, out float z̄) // TODO: integrate properly
            {
                if (nm < FirstNanometers || nm > LastNanometers) // no linear interpolation to zereos
                {
                    x̄ = ȳ = z̄ = 0;
                    return false;
                }

                int i = ((int)nm - FirstNanometers) / StepNanometers;
                x̄ = SamplesX[i];
                ȳ = SamplesY[i];
                z̄ = SamplesZ[i];

                float m = nm % StepNanometers;
                if (m == 0)
                    return true;

                i++;
                float highX = SamplesX[i];
                float highY = SamplesY[i];
                float highZ = SamplesZ[i];

                float w = (1f / StepNanometers) * m;

                x̄ = (1f - w) * x̄ + w * highX;
                ȳ = (1f - w) * ȳ + w * highY;
                z̄ = (1f - w) * z̄ + w * highZ;
                return true;
            }

            public IEnumerable<int> EnumerateNanometers()
            {
                for (int nm = FirstNanometers; nm <= LastNanometers; nm += StepNanometers)
                    yield return nm;
            }
            public IEnumerable<Color1931XYZ> EnumerateSamples()
            {
                for (int i = 0; i < SamplesX.Length; i++)
                    yield return new Color1931XYZ(SamplesX[i], SamplesY[i], SamplesZ[i]);
            }
            public IEnumerator<KeyValuePair<int, Color1931XYZ>> GetEnumerator()
            {
                for (int nm = FirstNanometers, i = 0; nm <= LastNanometers; nm += StepNanometers, i++)
                    yield return new KeyValuePair<int, Color1931XYZ>(nm, new Color1931XYZ(SamplesX[i], SamplesY[i], SamplesZ[i]));

            }
            System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator() => GetEnumerator();
        }

        // http://cvrl.ioo.ucl.ac.uk/cmfs.htm

        private static Lazy<_Cie2012XYZdeg2> _cie2012XYZdeg2 = new Lazy<_Cie2012XYZdeg2>(isThreadSafe: false);
        public static XYZ Cie2012XYZdeg2 => _cie2012XYZdeg2.Value;

        /// <summary>
        /// CIE (2012) 2-deg XYZ “physiologically-relevant” colour matching functions.
        /// </summary>
        /// <remarks>
        /// These 2-deg colour matching functions are linear transformations of the 2-deg cone fundamentals of Stockman & Sharpe (2000), ratified by the CIE (2006) as the new physiologically-relevant fundamental CIE CMFs.
        /// </remarks>
        internal class _Cie2012XYZdeg2 : XYZ
        {
            public const int Degrees = 2;

            public override int StepNanometers => 1;
            public override int FirstNanometers => 390;
            public override int LastNanometers => 830;

            protected override float[] SamplesX => X;
            protected override float[] SamplesY => Y;
            protected override float[] SamplesZ => Z;

            /// <summary>
            /// x̄(λ). 1 nm steps from 390 to 830.
            /// </summary>
            public static readonly float[] X = { 0.003769647f, 0.004532416f, 0.005446553f, 0.006538868f, 0.007839699f, 0.009382967f, 0.01120608f, 0.01334965f, 0.0158569f, 0.01877286f, 0.02214302f, 0.02601285f, 0.03043036f, 0.03544325f, 0.0410964f, 0.04742986f, 0.05447394f, 0.06223612f, 0.07070048f, 0.07982513f, 0.08953803f, 0.09974848f, 0.1104019f, 0.1214566f, 0.1328741f, 0.1446214f, 0.1566468f, 0.1687901f, 0.1808328f, 0.1925216f, 0.2035729f, 0.2137531f, 0.2231348f, 0.2319245f, 0.2403892f, 0.2488523f, 0.2575896f, 0.2664991f, 0.2753532f, 0.2838921f, 0.2918246f, 0.29892f, 0.3052993f, 0.3112031f, 0.3169047f, 0.3227087f, 0.3288194f, 0.3349242f, 0.3405452f, 0.3451688f, 0.3482554f, 0.3494153f, 0.3489075f, 0.3471746f, 0.3446705f, 0.3418483f, 0.339024f, 0.3359926f, 0.3324276f, 0.3280157f, 0.3224637f, 0.3156225f, 0.3078201f, 0.2994771f, 0.2909776f, 0.2826646f, 0.2747962f, 0.2674312f, 0.2605847f, 0.2542749f, 0.2485254f, 0.2433039f, 0.2383414f, 0.2333253f, 0.2279619f, 0.2219781f, 0.2151735f, 0.2075619f, 0.1992183f, 0.190229f, 0.1806905f, 0.1707154f, 0.1604471f, 0.1500244f, 0.1395705f, 0.129192f, 0.1189859f, 0.1090615f, 0.09951424f, 0.0904185f, 0.08182895f, 0.07376817f, 0.06619477f, 0.0590638f, 0.05234242f, 0.04600865f, 0.04006154f, 0.03454373f, 0.02949091f, 0.0249214f, 0.02083981f, 0.01723591f, 0.01407924f, 0.01134516f, 0.009019658f, 0.007097731f, 0.005571145f, 0.004394566f, 0.003516303f, 0.002887638f, 0.002461588f, 0.002206348f, 0.002149559f, 0.002337091f, 0.002818931f, 0.003649178f, 0.004891359f, 0.006629364f, 0.008942902f, 0.01190224f, 0.01556989f, 0.01997668f, 0.02504698f, 0.0306753f, 0.03674999f, 0.04315171f, 0.04978584f, 0.05668554f, 0.06391651f, 0.07154352f, 0.07962917f, 0.08821473f, 0.09726978f, 0.1067504f, 0.1166192f, 0.1268468f, 0.137406f, 0.1482471f, 0.1593076f, 0.1705181f, 0.1818026f, 0.193109f, 0.2045085f, 0.2161166f, 0.228065f, 0.2405015f, 0.2535441f, 0.26713f, 0.2811351f, 0.2954164f, 0.3098117f, 0.3241678f, 0.3384319f, 0.3525786f, 0.3665839f, 0.3804244f, 0.3940988f, 0.4076972f, 0.4213484f, 0.4352003f, 0.4494206f, 0.4641616f, 0.4794395f, 0.495218f, 0.5114395f, 0.5280233f, 0.5448696f, 0.5618898f, 0.5790137f, 0.5961882f, 0.6133784f, 0.6305897f, 0.6479223f, 0.6654866f, 0.6833782f, 0.7016774f, 0.720411f, 0.7394495f, 0.7586285f, 0.7777885f, 0.796775f, 0.815453f, 0.8337389f, 0.8515493f, 0.8687862f, 0.8853376f, 0.9011588f, 0.9165278f, 0.9318245f, 0.9474524f, 0.9638388f, 0.9812596f, 0.9992953f, 1.017343f, 1.03479f, 1.051011f, 1.065522f, 1.078421f, 1.089944f, 1.10032f, 1.109767f, 1.118438f, 1.126266f, 1.133138f, 1.138952f, 1.14362f, 1.147095f, 1.149464f, 1.150838f, 1.151326f, 1.151033f, 1.150002f, 1.148061f, 1.144998f, 1.140622f, 1.134757f, 1.127298f, 1.118342f, 1.108033f, 1.096515f, 1.083928f, 1.070387f, 1.055934f, 1.040592f, 1.024385f, 1.007344f, 0.9895268f, 0.9711213f, 0.9523257f, 0.9333248f, 0.9142877f, 0.8952798f, 0.8760157f, 0.8561607f, 0.8354235f, 0.8135565f, 0.7904565f, 0.7664364f, 0.7418777f, 0.7171219f, 0.6924717f, 0.66816f, 0.6442697f, 0.620845f, 0.5979243f, 0.575541f, 0.5537296f, 0.5325412f, 0.5120218f, 0.492207f, 0.4731224f, 0.4547417f, 0.4368719f, 0.4193121f, 0.401898f, 0.3844986f, 0.3670592f, 0.3497167f, 0.3326305f, 0.3159341f, 0.2997374f, 0.2841189f, 0.2691053f, 0.2547077f, 0.2409319f, 0.2277792f, 0.2152431f, 0.203301f, 0.1919276f, 0.1810987f, 0.1707914f, 0.1609842f, 0.1516577f, 0.1427936f, 0.1343737f, 0.1263808f, 0.1187979f, 0.1116088f, 0.1047975f, 0.09834835f, 0.09224597f, 0.08647506f, 0.08101986f, 0.07586514f, 0.07099633f, 0.0663996f, 0.06206225f, 0.05797409f, 0.05412533f, 0.050506f, 0.04710606f, 0.04391411f, 0.04091411f, 0.03809067f, 0.03543034f, 0.03292138f, 0.03055672f, 0.02834146f, 0.02628033f, 0.02437465f, 0.02262306f, 0.02101935f, 0.01954647f, 0.01818727f, 0.01692727f, 0.01575417f, 0.01465854f, 0.01363571f, 0.01268205f, 0.01179394f, 0.01096778f, 0.01019964f, 0.009484317f, 0.008816851f, 0.008192921f, 0.00760875f, 0.007061391f, 0.006549509f, 0.00607197f, 0.005627476f, 0.005214608f, 0.004831848f, 0.004477579f, 0.004150166f, 0.003847988f, 0.003569452f, 0.003312857f, 0.003076022f, 0.002856894f, 0.002653681f, 0.002464821f, 0.00228906f, 0.002125694f, 0.001974121f, 0.001833723f, 0.001703876f, 0.001583904f, 0.001472939f, 0.001370151f, 0.001274803f, 0.001186238f, 0.001103871f, 0.001027194f, 0.000955749f, 0.000889126f, 0.000826954f, 0.000768935f, 0.000714943f, 0.000664859f, 0.000618542f, 0.00057583f, 0.000536505f, 0.000500184f, 0.000466501f, 0.000435139f, 0.00040583f, 0.000378373f, 0.000352689f, 0.00032872f, 0.0003064f, 0.000285658f, 0.000266411f, 0.000248546f, 0.000231953f, 0.00021653f, 0.000202185f, 0.000188834f, 0.000176394f, 0.00016479f, 0.000153954f, 0.000143827f, 0.000134357f, 0.000125514f, 0.000117271f, 0.000109598f, 0.000102469f, 9.58472E-05f, 8.96832E-05f, 8.39273E-05f, 7.85371E-05f, 7.34755E-05f, 6.87158E-05f, 6.42526E-05f, 6.00829E-05f, 5.6201E-05f, 5.25987E-05f, 4.92628E-05f, 4.61662E-05f, 4.32821E-05f, 4.05872E-05f, 3.80611E-05f, 3.56882E-05f, 3.34602E-05f, 3.13709E-05f, 2.94137E-05f, 2.75822E-05f, 2.58695E-05f, 2.4267E-05f, 2.27664E-05f, 2.13601E-05f, 2.00412E-05f, 1.88038E-05f, 1.76436E-05f, 1.65567E-05f, 1.55394E-05f, 1.45879E-05f, 1.36985E-05f, 1.28671E-05f, 1.20895E-05f, 1.13621E-05f, 1.06814E-05f, 1.00441E-05f, 9.4464E-06f, 8.88475E-06f, 8.35605E-06f, 7.85752E-06f, 7.387E-06f, 6.94358E-06f, 6.52655E-06f, 6.13509E-06f, 5.76828E-06f, 5.42507E-06f, 5.10397E-06f, 4.80353E-06f, 4.52235E-06f, 4.25917E-06f, 4.01272E-06f, 3.7816E-06f, 3.5645E-06f, 3.36024E-06f, 3.16777E-06f, 2.98621E-06f, 2.815E-06f, 2.65366E-06f, 2.50173E-06f, 2.35872E-06f, 2.22421E-06f, 2.09774E-06f, 1.97889E-06f, 1.86727E-06f, 1.76247E-06f };
            /// <summary>
            /// ȳ(λ). 1 nm steps from 390 to 830.
            /// </summary>
            public static readonly float[] Y = { 0.000414616f, 0.000502833f, 0.000608499f, 0.000734444f, 0.000883739f, 0.001059646f, 0.001265532f, 0.001504753f, 0.001780493f, 0.002095572f, 0.002452194f, 0.002852216f, 0.003299115f, 0.003797466f, 0.004352768f, 0.004971717f, 0.005661014f, 0.006421615f, 0.007250312f, 0.008140173f, 0.00907986f, 0.01005608f, 0.01106456f, 0.01210522f, 0.01318014f, 0.01429377f, 0.01545004f, 0.01664093f, 0.01785302f, 0.01907018f, 0.02027369f, 0.02144805f, 0.02260041f, 0.02374789f, 0.02491247f, 0.02612106f, 0.02739923f, 0.02874993f, 0.03016909f, 0.03165145f, 0.03319038f, 0.03477912f, 0.03641495f, 0.03809569f, 0.03981843f, 0.0415794f, 0.04337098f, 0.0451718f, 0.0469542f, 0.04868718f, 0.05033657f, 0.05187611f, 0.05332218f, 0.05470603f, 0.05606335f, 0.05743393f, 0.05885107f, 0.06030809f, 0.06178644f, 0.0632657f, 0.06472352f, 0.06614749f, 0.06757256f, 0.06904928f, 0.0706328f, 0.07238339f, 0.0743596f, 0.07659383f, 0.07911436f, 0.08195345f, 0.08514816f, 0.08872657f, 0.09266008f, 0.09689723f, 0.1013746f, 0.1060145f, 0.1107377f, 0.1155111f, 0.1203122f, 0.1251161f, 0.1298957f, 0.1346299f, 0.1393309f, 0.1440235f, 0.1487372f, 0.1535066f, 0.1583644f, 0.1633199f, 0.1683761f, 0.1735365f, 0.1788048f, 0.1841819f, 0.1896559f, 0.1952101f, 0.2008259f, 0.2064828f, 0.2121826f, 0.2180279f, 0.2241586f, 0.2307302f, 0.237916f, 0.2458706f, 0.2546023f, 0.264076f, 0.274249f, 0.285068f, 0.2964837f, 0.308501f, 0.3211393f, 0.3344175f, 0.3483536f, 0.3629601f, 0.3782275f, 0.3941359f, 0.4106582f, 0.4277595f, 0.4453993f, 0.4635396f, 0.4821376f, 0.501143f, 0.5204972f, 0.5401387f, 0.5600208f, 0.5800972f, 0.6003172f, 0.6206256f, 0.6409398f, 0.6610772f, 0.6808134f, 0.6999044f, 0.718089f, 0.7351593f, 0.7511821f, 0.7663143f, 0.7807352f, 0.7946448f, 0.8082074f, 0.8213817f, 0.8340701f, 0.8461711f, 0.8575799f, 0.8682408f, 0.8783061f, 0.8879907f, 0.8975211f, 0.9071347f, 0.9169947f, 0.9269295f, 0.9366731f, 0.9459482f, 0.9544675f, 0.9619834f, 0.968439f, 0.9738289f, 0.9781519f, 0.9814106f, 0.9836669f, 0.9852081f, 0.9863813f, 0.9875357f, 0.9890228f, 0.9910811f, 0.9934913f, 0.9959172f, 0.9980205f, 0.9994608f, 0.999993f, 0.9997557f, 0.9989839f, 0.9979123f, 0.9967737f, 0.9957356f, 0.9947115f, 0.9935534f, 0.9921156f, 0.9902549f, 0.9878596f, 0.9849324f, 0.9815036f, 0.9776035f, 0.9732611f, 0.9684764f, 0.9631369f, 0.9571062f, 0.950254f, 0.9424569f, 0.9336897f, 0.9242893f, 0.9146707f, 0.9052333f, 0.8963613f, 0.8883069f, 0.8808462f, 0.8736445f, 0.8663755f, 0.8587203f, 0.8504295f, 0.8415047f, 0.8320109f, 0.8220154f, 0.8115868f, 0.8007874f, 0.7896515f, 0.7782053f, 0.7664733f, 0.7544785f, 0.7422473f, 0.7298229f, 0.7172525f, 0.7045818f, 0.6918553f, 0.6791009f, 0.6662846f, 0.6533595f, 0.6402807f, 0.6270066f, 0.6135148f, 0.5998494f, 0.5860682f, 0.5722261f, 0.5583746f, 0.5445535f, 0.5307673f, 0.517013f, 0.5032889f, 0.489595f, 0.4759442f, 0.4623958f, 0.4490154f, 0.4358622f, 0.4229897f, 0.4104152f, 0.3980356f, 0.38573f, 0.3733907f, 0.3609245f, 0.348286f, 0.3355702f, 0.3228963f, 0.3103704f, 0.2980865f, 0.286116f, 0.2744822f, 0.2631953f, 0.2522628f, 0.2416902f, 0.2314809f, 0.2216378f, 0.2121622f, 0.2030542f, 0.1943124f, 0.1859227f, 0.1778274f, 0.1699654f, 0.1622841f, 0.1547397f, 0.1473081f, 0.1400169f, 0.1329013f, 0.1259913f, 0.119312f, 0.112882f, 0.1067113f, 0.1008052f, 0.09516653f, 0.08979594f, 0.08469044f, 0.07984009f, 0.07523372f, 0.07086061f, 0.06671045f, 0.0627736f, 0.05904179f, 0.05550703f, 0.05216139f, 0.04899699f, 0.04600578f, 0.04317885f, 0.04050755f, 0.03798376f, 0.03559982f, 0.03334856f, 0.03122332f, 0.0292178f, 0.02732601f, 0.02554223f, 0.02386121f, 0.02227859f, 0.0207902f, 0.01939185f, 0.01807939f, 0.01684817f, 0.01569188f, 0.01460446f, 0.01358062f, 0.01261573f, 0.01170696f, 0.01085608f, 0.01006476f, 0.009333376f, 0.008661284f, 0.008046048f, 0.00748113f, 0.006959987f, 0.00647707f, 0.006027677f, 0.005608169f, 0.005216691f, 0.004851785f, 0.004512008f, 0.004195941f, 0.003902057f, 0.003628371f, 0.003373005f, 0.003134315f, 0.002910864f, 0.002701528f, 0.002505796f, 0.002323231f, 0.002153333f, 0.001995557f, 0.001849316f, 0.001713976f, 0.001588899f, 0.001473453f, 0.001367022f, 0.001268954f, 0.001178421f, 0.001094644f, 0.001016943f, 0.000944727f, 0.000877517f, 0.000815044f, 0.000757076f, 0.000703376f, 0.000653705f, 0.000607805f, 0.000565344f, 0.000526005f, 0.000489506f, 0.000455597f, 0.000424055f, 0.000394686f, 0.000367318f, 0.000341794f, 0.000317974f, 0.000295744f, 0.000275056f, 0.000255864f, 0.000238114f, 0.000221745f, 0.000206671f, 0.000192747f, 0.000179832f, 0.000167802f, 0.000156557f, 0.000146017f, 0.000136154f, 0.000126945f, 0.000118367f, 0.000110393f, 0.000102991f, 9.61184E-05f, 8.97332E-05f, 8.37969E-05f, 7.82744E-05f, 7.31331E-05f, 6.83414E-05f, 6.38704E-05f, 5.96939E-05f, 5.57886E-05f, 5.21351E-05f, 4.87218E-05f, 4.55385E-05f, 4.25744E-05f, 3.98188E-05f, 3.72588E-05f, 3.48747E-05f, 3.26477E-05f, 3.05614E-05f, 2.86018E-05f, 2.67584E-05f, 2.50294E-05f, 2.34137E-05f, 2.19091E-05f, 2.05126E-05f, 1.9219E-05f, 1.8018E-05f, 1.6899E-05f, 1.58531E-05f, 1.48724E-05f, 1.39509E-05f, 1.30853E-05f, 1.22733E-05f, 1.15123E-05f, 1.08E-05f, 1.01336E-05f, 9.50992E-06f, 8.92563E-06f, 8.37785E-06f, 7.86392E-06f, 7.38154E-06f, 6.9291E-06f, 6.50514E-06f, 6.10822E-06f, 5.73694E-06f, 5.38983E-06f, 5.06527E-06f, 4.76167E-06f, 4.47756E-06f, 4.2116E-06f, 3.96246E-06f, 3.72867E-06f, 3.50888E-06f, 3.30187E-06f, 3.10656E-06f, 2.92212E-06f, 2.74821E-06f, 2.58456E-06f, 2.43087E-06f, 2.28679E-06f, 2.15191E-06f, 2.02566E-06f, 1.90746E-06f, 1.79679E-06f, 1.69315E-06f, 1.59603E-06f, 1.5049E-06f, 1.41925E-06f, 1.3386E-06f, 1.26256E-06f, 1.19077E-06f, 1.12303E-06f, 1.05915E-06f, 9.98951E-07f, 9.42251E-07f, 8.8888E-07f, 8.38669E-07f, 7.91454E-07f, 7.47077E-07f, 7.05386E-07f };
            /// <summary>
            /// z̄(λ). 1 nm steps from 390 to 830.
            /// </summary>
            public static readonly float[] Z = { 0.0184726f, 0.02221101f, 0.02669819f, 0.03206937f, 0.03847832f, 0.04609784f, 0.05511953f, 0.06575257f, 0.07822113f, 0.09276013f, 0.109609f, 0.1290077f, 0.1512047f, 0.1764441f, 0.2049517f, 0.2369246f, 0.2725123f, 0.311782f, 0.3547064f, 0.4011473f, 0.4508369f, 0.5034164f, 0.5586361f, 0.6162734f, 0.6760982f, 0.7378822f, 0.8013019f, 0.8655573f, 0.9295791f, 0.9921293f, 1.051821f, 1.107509f, 1.159527f, 1.208869f, 1.256834f, 1.305008f, 1.354758f, 1.405594f, 1.456414f, 1.50596f, 1.552826f, 1.595902f, 1.635768f, 1.673573f, 1.710604f, 1.74828f, 1.787504f, 1.826609f, 1.863108f, 1.894332f, 1.917479f, 1.930529f, 1.934819f, 1.93265f, 1.926395f, 1.918437f, 1.91043f, 1.901224f, 1.889f, 1.871996f, 1.848545f, 1.817792f, 1.781627f, 1.742514f, 1.702749f, 1.664439f, 1.629207f, 1.59736f, 1.568896f, 1.543823f, 1.522157f, 1.503611f, 1.486673f, 1.469595f, 1.450709f, 1.42844f, 1.401587f, 1.370094f, 1.33422f, 1.294275f, 1.25061f, 1.203696f, 1.154316f, 1.103284f, 1.051347f, 0.9991789f, 0.9473958f, 0.8966222f, 0.8473981f, 0.8001576f, 0.7552379f, 0.7127879f, 0.6725198f, 0.6340976f, 0.5972433f, 0.5617313f, 0.5274921f, 0.4948809f, 0.4642586f, 0.4358841f, 0.4099313f, 0.3864261f, 0.3650566f, 0.3454812f, 0.3274095f, 0.3105939f, 0.2948102f, 0.2798194f, 0.26541f, 0.2514084f, 0.2376753f, 0.2241211f, 0.2107484f, 0.1975839f, 0.1846574f, 0.1720018f, 0.1596918f, 0.1479415f, 0.1369428f, 0.1268279f, 0.1176796f, 0.109497f, 0.1020943f, 0.09527993f, 0.08890075f, 0.08283548f, 0.07700982f, 0.07144001f, 0.06615436f, 0.06117199f, 0.05650407f, 0.05215121f, 0.04809566f, 0.0443172f, 0.04079734f, 0.03751912f, 0.03446846f, 0.03163764f, 0.02901901f, 0.02660364f, 0.02438164f, 0.02234097f, 0.02046415f, 0.01873456f, 0.01713788f, 0.01566174f, 0.01429644f, 0.01303702f, 0.01187897f, 0.01081725f, 0.00984647f, 0.008960687f, 0.008152811f, 0.007416025f, 0.006744115f, 0.006131421f, 0.005572778f, 0.005063463f, 0.004599169f, 0.004175971f, 0.003790291f, 0.003438952f, 0.003119341f, 0.002829038f, 0.002565722f, 0.002327186f, 0.00211128f, 0.001915766f, 0.001738589f, 0.00157792f, 0.001432128f, 0.001299781f, 0.001179667f, 0.001070694f, 0.000971862f, 0.000882253f, 0.000801023f, 0.000727388f, 0.000660635f, 0.000600115f, 0.000545242f, 0.000495485f, 0.000450364f, 0.000409446f, 0.000372335f, 0.000338674f, 0.00030814f, 0.000280437f, 0.0002553f, 0.000232486f, 0.000211777f, 0.000192976f, 0.000175902f, 0.000160395f, 0.000146306f, 0.000133503f, 0.000121866f, 0.000111286f, 0.000101663f, 9.291E-05f, 8.49447E-05f, 7.76943E-05f, 7.10925E-05f, 6.50794E-05f, 5.96006E-05f, 5.46071E-05f, 5.00542E-05f, 4.59016E-05f, 4.21127E-05f, 3.86544E-05f, 3.54966E-05f, 3.26122E-05f, 2.99764E-05f, 2.75669E-05f, 2.53634E-05f, 2.33474E-05f, 2.15022E-05f, 1.98127E-05f, 0.000018265f, 1.68467E-05f, 1.55463E-05f, 1.43536E-05f, 1.32592E-05f, 1.22544E-05f, 1.13317E-05f, 1.04839E-05f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f };
        }

        private static Lazy<_Cie2012XYZdeg10> _cie2012XYZdeg10 = new Lazy<_Cie2012XYZdeg10>(isThreadSafe: false);
        public static XYZ Cie2012XYZdeg10 => _cie2012XYZdeg10.Value;

        /// <summary>
        /// CIE (2012) 10-deg XYZ “physiologically-relevant” colour matching functions.
        /// </summary>
        internal class _Cie2012XYZdeg10 : XYZ
        {
            public const int Degrees = 10;

            public override int StepNanometers => 1;
            public override int FirstNanometers => 390;
            public override int LastNanometers => 830;

            protected override float[] SamplesX => X;
            protected override float[] SamplesY => Y;
            protected override float[] SamplesZ => Z;

            /// <summary>
            /// x̄(λ). 1 nm steps from 390 to 830.
            /// </summary>
            public readonly float[] X = { 0.00295242f, 0.003577275f, 0.004332146f, 0.005241609f, 0.006333902f, 0.007641137f, 0.009199401f, 0.01104869f, 0.01323262f, 0.01579791f, 0.01879338f, 0.02226949f, 0.02627978f, 0.03087862f, 0.0361189f, 0.04204986f, 0.04871256f, 0.05612868f, 0.06429866f, 0.07319818f, 0.08277331f, 0.09295327f, 0.1037137f, 0.115052f, 0.1269771f, 0.1395127f, 0.1526661f, 0.1663054f, 0.1802197f, 0.1941448f, 0.2077647f, 0.2207911f, 0.2332355f, 0.2452462f, 0.2570397f, 0.2688989f, 0.2810677f, 0.2933967f, 0.3055933f, 0.3173165f, 0.3281798f, 0.3378678f, 0.3465097f, 0.3543953f, 0.3618655f, 0.3693084f, 0.3770107f, 0.384685f, 0.3918591f, 0.3980192f, 0.4026189f, 0.4052637f, 0.4062482f, 0.406066f, 0.4052283f, 0.4042529f, 0.4034808f, 0.4025362f, 0.4008675f, 0.3979327f, 0.3932139f, 0.3864108f, 0.3779513f, 0.3684176f, 0.3583473f, 0.3482214f, 0.338383f, 0.3288309f, 0.3194977f, 0.3103345f, 0.3013112f, 0.2923754f, 0.2833273f, 0.2739463f, 0.2640352f, 0.2534221f, 0.2420135f, 0.2299346f, 0.2173617f, 0.2044672f, 0.1914176f, 0.1783672f, 0.1654407f, 0.1527391f, 0.1403439f, 0.1283167f, 0.1167124f, 0.1056121f, 0.09508569f, 0.08518206f, 0.0759312f, 0.06733159f, 0.05932018f, 0.05184106f, 0.04486119f, 0.0383677f, 0.03237296f, 0.02692095f, 0.0220407f, 0.01773951f, 0.01400745f, 0.01082291f, 0.008168996f, 0.006044623f, 0.004462638f, 0.00344681f, 0.003009513f, 0.003090744f, 0.003611221f, 0.004491435f, 0.005652072f, 0.007035322f, 0.008669631f, 0.01060755f, 0.01290468f, 0.01561956f, 0.0188164f, 0.02256923f, 0.02694456f, 0.0319991f, 0.03778185f, 0.04430635f, 0.05146516f, 0.05912224f, 0.0671422f, 0.07538941f, 0.08376697f, 0.09233581f, 0.101194f, 0.1104362f, 0.1201511f, 0.130396f, 0.141131f, 0.1522944f, 0.1638288f, 0.1756832f, 0.1878114f, 0.2001621f, 0.2126822f, 0.2253199f, 0.2380254f, 0.2507787f, 0.2636778f, 0.2768607f, 0.2904792f, 0.3046991f, 0.3196485f, 0.3352447f, 0.351329f, 0.3677148f, 0.3841856f, 0.4005312f, 0.4166669f, 0.432542f, 0.4481063f, 0.4633109f, 0.478144f, 0.4927483f, 0.5073315f, 0.5221315f, 0.537417f, 0.5534217f, 0.5701242f, 0.5874093f, 0.6051269f, 0.6230892f, 0.6410999f, 0.6590659f, 0.6769436f, 0.6947143f, 0.7123849f, 0.7299978f, 0.7476478f, 0.765425f, 0.7834009f, 0.8016277f, 0.8201041f, 0.8386843f, 0.8571936f, 0.8754652f, 0.8933408f, 0.9106772f, 0.9273554f, 0.9432502f, 0.9582244f, 0.9721304f, 0.9849237f, 0.9970067f, 1.008907f, 1.021163f, 1.034327f, 1.048753f, 1.063937f, 1.079166f, 1.093723f, 1.106886f, 1.118106f, 1.127493f, 1.135317f, 1.141838f, 1.147304f, 1.151897f, 1.155582f, 1.158284f, 1.159934f, 1.160477f, 1.15989f, 1.158259f, 1.155692f, 1.152293f, 1.148163f, 1.143345f, 1.137685f, 1.130993f, 1.123097f, 1.113846f, 1.103152f, 1.091121f, 1.077902f, 1.063644f, 1.048485f, 1.032546f, 1.01587f, 0.9984859f, 0.9804227f, 0.9617111f, 0.9424119f, 0.9227049f, 0.9027804f, 0.8828123f, 0.8629581f, 0.8432731f, 0.8234742f, 0.8032342f, 0.7822715f, 0.7603498f, 0.7373739f, 0.713647f, 0.6895336f, 0.6653567f, 0.6413984f, 0.6178723f, 0.5948484f, 0.57236f, 0.5504353f, 0.5290979f, 0.5083728f, 0.4883006f, 0.4689171f, 0.4502486f, 0.4323126f, 0.415079f, 0.3983657f, 0.3819846f, 0.3657821f, 0.3496358f, 0.3334937f, 0.3174776f, 0.3017298f, 0.2863684f, 0.27149f, 0.2571632f, 0.2434102f, 0.2302389f, 0.2176527f, 0.2056507f, 0.1942251f, 0.183353f, 0.1730097f, 0.1631716f, 0.1538163f, 0.144923f, 0.1364729f, 0.1284483f, 0.120832f, 0.1136072f, 0.1067579f, 0.1002685f, 0.09412394f, 0.08830929f, 0.0828101f, 0.07761208f, 0.07270064f, 0.06806167f, 0.06368176f, 0.05954815f, 0.05564917f, 0.05197543f, 0.04851788f, 0.04526737f, 0.04221473f, 0.03934954f, 0.0366573f, 0.03412407f, 0.03173768f, 0.02948752f, 0.02736717f, 0.02538113f, 0.02353356f, 0.02182558f, 0.0202559f, 0.01881892f, 0.0174993f, 0.01628167f, 0.01515301f, 0.0141023f, 0.01312106f, 0.01220509f, 0.01135114f, 0.01055593f, 0.009816228f, 0.009128517f, 0.008488116f, 0.007890589f, 0.007332061f, 0.006809147f, 0.006319204f, 0.005861036f, 0.005433624f, 0.005035802f, 0.004666298f, 0.00432375f, 0.004006709f, 0.003713708f, 0.003443294f, 0.003194041f, 0.002964424f, 0.002752492f, 0.002556406f, 0.002374564f, 0.002205568f, 0.002048294f, 0.001902113f, 0.001766485f, 0.001640857f, 0.001524672f, 0.001417322f, 0.001318031f, 0.001226059f, 0.001140743f, 0.001061495f, 0.000987795f, 0.000919185f, 0.000855257f, 0.000795643f, 0.000740012f, 0.000688098f, 0.000639786f, 0.000594973f, 0.000553529f, 0.000515311f, 0.000480123f, 0.000447625f, 0.000417485f, 0.000389422f, 0.000363197f, 0.000338628f, 0.000315645f, 0.000294197f, 0.000274224f, 0.000255662f, 0.000238439f, 0.000222453f, 0.000207604f, 0.000193802f, 0.000180965f, 0.000169017f, 0.000157884f, 0.000147499f, 0.000137803f, 0.000128739f, 0.000120264f, 0.00011235f, 0.000104973f, 9.8106E-05f, 9.17248E-05f, 8.57986E-05f, 8.02817E-05f, 7.51301E-05f, 7.03057E-05f, 6.57753E-05f, 6.15151E-05f, 5.75203E-05f, 5.37881E-05f, 5.03135E-05f, 4.70892E-05f, 4.41032E-05f, 4.13315E-05f, 3.87499E-05f, 3.63376E-05f, 3.40765E-05f, 3.19524E-05f, 2.99581E-05f, 2.80878E-05f, 2.63358E-05f, 2.46963E-05f, 2.31631E-05f, 2.17286E-05f, 2.03852E-05f, 1.91263E-05f, 1.79456E-05f, 1.68378E-05f, 1.57991E-05f, 1.4826E-05f, 1.39153E-05f, 1.30635E-05f, 1.22672E-05f, 1.15228E-05f, 1.08266E-05f, 1.01754E-05f, 9.56599E-06f, 8.99541E-06f, 8.46025E-06f, 7.95738E-06f, 7.484E-06f, 7.03762E-06f, 6.61631E-06f, 6.21927E-06f, 5.84584E-06f, 5.49531E-06f, 5.16685E-06f, 4.85951E-06f, 4.57197E-06f, 4.30292E-06f, 4.05112E-06f, 3.81543E-06f, 3.59472E-06f, 3.38774E-06f, 3.1933E-06f, 3.01036E-06f, 2.83798E-06f, 2.67537E-06f, 2.52202E-06f, 2.37751E-06f, 2.24142E-06f, 2.11333E-06f, 1.99283E-06f, 1.87954E-06f, 1.77308E-06f, 1.67309E-06f, 1.5792E-06f };
            /// <summary>
            /// ȳ(λ). 1 nm steps from 390 to 830.
            /// </summary>
            public readonly float[] Y = { 0.000407678f, 0.000497777f, 0.000606475f, 0.000737004f, 0.000892939f, 0.001078166f, 0.001296816f, 0.001553159f, 0.001851463f, 0.002195795f, 0.002589775f, 0.003036799f, 0.003541926f, 0.004111422f, 0.004752618f, 0.005474207f, 0.006285034f, 0.007188068f, 0.008181786f, 0.009260417f, 0.01041303f, 0.01162642f, 0.01289884f, 0.01423442f, 0.0156408f, 0.01712968f, 0.01871265f, 0.02038394f, 0.02212935f, 0.02392985f, 0.02576133f, 0.02760156f, 0.02945513f, 0.03133884f, 0.03327575f, 0.03529554f, 0.03742705f, 0.03967137f, 0.04201998f, 0.04446166f, 0.04698226f, 0.04956742f, 0.05221219f, 0.05491387f, 0.05766919f, 0.06047429f, 0.06332195f, 0.06619271f, 0.06906185f, 0.0719019f, 0.07468288f, 0.07738452f, 0.08003601f, 0.08268524f, 0.08538745f, 0.08820537f, 0.09118925f, 0.09431041f, 0.09751346f, 0.1007349f, 0.103903f, 0.1069639f, 0.1099676f, 0.1129992f, 0.1161541f, 0.1195389f, 0.1232503f, 0.1273047f, 0.1316964f, 0.1364178f, 0.1414586f, 0.1468003f, 0.1524002f, 0.1582021f, 0.16414f, 0.1701373f, 0.1761233f, 0.1820896f, 0.1880463f, 0.1940065f, 0.1999859f, 0.2060054f, 0.2120981f, 0.2183041f, 0.2246686f, 0.2312426f, 0.2380741f, 0.2451798f, 0.2525682f, 0.2602479f, 0.2682271f, 0.2765005f, 0.2850035f, 0.2936475f, 0.3023319f, 0.3109438f, 0.3194105f, 0.3278683f, 0.3365263f, 0.3456176f, 0.3554018f, 0.3660893f, 0.3775857f, 0.389696f, 0.4021947f, 0.4148227f, 0.4273539f, 0.4398206f, 0.452336f, 0.4650298f, 0.4780482f, 0.4915173f, 0.5054224f, 0.5197057f, 0.5343012f, 0.5491344f, 0.5641302f, 0.5792416f, 0.5944264f, 0.6096388f, 0.6248296f, 0.6399656f, 0.6550943f, 0.6702903f, 0.6856375f, 0.7012292f, 0.7171103f, 0.7330917f, 0.7489041f, 0.764253f, 0.7788199f, 0.792341f, 0.804851f, 0.8164747f, 0.827352f, 0.8376358f, 0.8474653f, 0.8568868f, 0.8659242f, 0.8746041f, 0.8829552f, 0.8910274f, 0.8989495f, 0.9068753f, 0.9149652f, 0.9233858f, 0.9322325f, 0.9412862f, 0.9502378f, 0.9587647f, 0.9665325f, 0.9732504f, 0.9788415f, 0.9832867f, 0.986572f, 0.9886887f, 0.9897056f, 0.9899849f, 0.9899624f, 0.9900731f, 0.99075f, 0.9922826f, 0.9943837f, 0.9966221f, 0.9985649f, 0.9997775f, 0.999944f, 0.99922f, 0.9978793f, 0.9961934f, 0.9944304f, 0.9927831f, 0.9911578f, 0.9893925f, 0.9873288f, 0.9848127f, 0.9817253f, 0.9780714f, 0.973886f, 0.9692028f, 0.9640545f, 0.9584409f, 0.9522379f, 0.9452968f, 0.9374773f, 0.9286495f, 0.9187953f, 0.9083014f, 0.8976352f, 0.8872401f, 0.877536f, 0.868792f, 0.8607474f, 0.8530233f, 0.8452535f, 0.8370838f, 0.8282409f, 0.818732f, 0.8086352f, 0.7980296f, 0.786995f, 0.775604f, 0.7638996f, 0.7519157f, 0.7396832f, 0.7272309f, 0.7145878f, 0.7017926f, 0.6888866f, 0.6759103f, 0.6629035f, 0.6498911f, 0.636841f, 0.6237092f, 0.6104541f, 0.5970375f, 0.5834395f, 0.5697044f, 0.5558892f, 0.5420475f, 0.5282296f, 0.5144746f, 0.5007881f, 0.4871687f, 0.473616f, 0.4601308f, 0.446726f, 0.4334589f, 0.4203919f, 0.407581f, 0.3950755f, 0.3828894f, 0.370919f, 0.3590447f, 0.3471615f, 0.3351794f, 0.3230562f, 0.3108859f, 0.298784f, 0.2868527f, 0.2751807f, 0.2638343f, 0.252833f, 0.2421835f, 0.2318904f, 0.2219564f, 0.2123826f, 0.2031698f, 0.1943179f, 0.185825f, 0.1776882f, 0.1698926f, 0.1623822f, 0.1550986f, 0.1479918f, 0.1410203f, 0.1341614f, 0.1274401f, 0.1208887f, 0.1145345f, 0.1083996f, 0.1025007f, 0.09684588f, 0.09143944f, 0.08628318f, 0.08137687f, 0.07671708f, 0.07229404f, 0.06809696f, 0.06411549f, 0.06033976f, 0.05676054f, 0.05336992f, 0.05016027f, 0.04712405f, 0.04425383f, 0.04154205f, 0.03898042f, 0.03656091f, 0.03427597f, 0.03211852f, 0.03008192f, 0.02816001f, 0.02634698f, 0.02463731f, 0.02302574f, 0.02150743f, 0.02007838f, 0.01873474f, 0.01747269f, 0.01628841f, 0.01517767f, 0.01413473f, 0.01315408f, 0.01223092f, 0.01136106f, 0.0105419f, 0.00977505f, 0.009061962f, 0.008402962f, 0.007797457f, 0.00724323f, 0.006734381f, 0.006265001f, 0.005830085f, 0.005425391f, 0.005047634f, 0.00469514f, 0.004366592f, 0.004060685f, 0.00377614f, 0.003511578f, 0.003265211f, 0.003035344f, 0.002820496f, 0.002619372f, 0.00243096f, 0.002254796f, 0.002090489f, 0.001937586f, 0.001795595f, 0.001663989f, 0.001542195f, 0.001429639f, 0.001325752f, 0.00122998f, 0.001141734f, 0.001060269f, 0.000984885f, 0.00091497f, 0.00084999f, 0.000789516f, 0.000733304f, 0.000681146f, 0.000632829f, 0.000588138f, 0.000546839f, 0.000508635f, 0.00047324f, 0.000440402f, 0.000409893f, 0.000381514f, 0.00035509f, 0.000330467f, 0.000307503f, 0.000286072f, 0.000266072f, 0.000247459f, 0.000230192f, 0.000214223f, 0.000199495f, 0.000185934f, 0.000173407f, 0.000161787f, 0.000150964f, 0.000140847f, 0.000131364f, 0.000122491f, 0.000114206f, 0.000106489f, 9.93144E-05f, 9.26551E-05f, 8.64723E-05f, 8.07278E-05f, 7.53872E-05f, 7.04188E-05f, 6.57934E-05f, 6.14825E-05f, 5.74601E-05f, 5.37027E-05f, 5.01893E-05f, 4.69025E-05f, 4.38317E-05f, 4.09678E-05f, 3.83012E-05f, 3.58222E-05f, 3.3519E-05f, 3.13742E-05f, 2.93707E-05f, 2.74938E-05f, 2.57308E-05f, 2.40725E-05f, 2.2517E-05f, 2.10635E-05f, 1.97099E-05f, 1.84535E-05f, 1.72898E-05f, 1.62093E-05f, 1.52026E-05f, 1.42617E-05f, 1.33795E-05f, 1.25504E-05f, 1.17717E-05f, 1.10412E-05f, 1.03566E-05f, 9.7158E-06f, 9.11632E-06f, 8.5552E-06f, 8.02956E-06f, 7.53677E-06f, 7.07442E-06f, 6.64046E-06f, 6.23344E-06f, 5.85204E-06f, 5.49496E-06f, 5.16095E-06f, 4.84869E-06f, 4.55671E-06f, 4.28358E-06f, 4.02799E-06f, 3.78873E-06f, 3.5646E-06f, 3.35429E-06f, 3.15656E-06f, 2.97033E-06f, 2.79463E-06f, 2.6287E-06f, 2.47225E-06f, 2.32503E-06f, 2.18677E-06f, 2.05715E-06f, 1.93581E-06f, 1.82224E-06f, 1.71591E-06f, 1.61636E-06f, 1.52311E-06f, 1.43575E-06f, 1.35377E-06f, 1.27671E-06f, 1.20417E-06f, 1.13576E-06f, 1.07118E-06f, 1.01024E-06f, 9.52778E-07f, 8.98622E-07f, 8.47617E-07f, 7.99605E-07f, 7.54436E-07f, 7.11962E-07f, 6.72042E-07f, 6.34538E-07f };
            /// <summary>
            /// z̄(λ). 1 nm steps from 390 to 830.
            /// </summary>
            public readonly float[] Z = { 0.01318752f, 0.01597879f, 0.01935758f, 0.02343758f, 0.02835021f, 0.03424588f, 0.04129467f, 0.04968641f, 0.05962964f, 0.07134926f, 0.08508254f, 0.1010753f, 0.1195838f, 0.1408647f, 0.1651644f, 0.1927065f, 0.2236782f, 0.2582109f, 0.2963632f, 0.3381018f, 0.3832822f, 0.4316884f, 0.483244f, 0.5379345f, 0.595774f, 0.6568187f, 0.7210459f, 0.7878635f, 0.8563391f, 0.9253017f, 0.9933444f, 1.059178f, 1.122832f, 1.184947f, 1.246476f, 1.308674f, 1.372628f, 1.437661f, 1.502449f, 1.565456f, 1.62494f, 1.679488f, 1.729668f, 1.776755f, 1.822228f, 1.867751f, 1.914504f, 1.961055f, 2.005136f, 2.044296f, 2.075946f, 2.098231f, 2.112591f, 2.121427f, 2.127239f, 2.132574f, 2.139093f, 2.144815f, 2.146832f, 2.14225f, 2.128264f, 2.103205f, 2.069388f, 2.03003f, 1.988178f, 1.946651f, 1.907521f, 1.870689f, 1.835578f, 1.801657f, 1.76844f, 1.735338f, 1.701254f, 1.665053f, 1.625712f, 1.582342f, 1.534439f, 1.482544f, 1.427438f, 1.369876f, 1.310576f, 1.250226f, 1.189511f, 1.12905f, 1.069379f, 1.010952f, 0.9541809f, 0.8995253f, 0.847372f, 0.7980093f, 0.7516389f, 0.7082645f, 0.6673867f, 0.6284798f, 0.5911174f, 0.5549619f, 0.5198843f, 0.4862772f, 0.4545497f, 0.4249955f, 0.3978114f, 0.3730218f, 0.3502618f, 0.3291407f, 0.3093356f, 0.2905816f, 0.2726773f, 0.2555143f, 0.2390188f, 0.2231335f, 0.2078158f, 0.1930407f, 0.1788089f, 0.1651287f, 0.1520103f, 0.1394643f, 0.1275353f, 0.1163771f, 0.1061161f, 0.09682266f, 0.08852389f, 0.08118263f, 0.07463132f, 0.06870644f, 0.06327834f, 0.05824484f, 0.05353812f, 0.04914863f, 0.04507511f, 0.04131175f, 0.03784916f, 0.03467234f, 0.03175471f, 0.02907029f, 0.02659651f, 0.02431375f, 0.02220677f, 0.02026852f, 0.01849246f, 0.01687084f, 0.01539505f, 0.0140545f, 0.01283354f, 0.01171754f, 0.01069415f, 0.009753f, 0.008886096f, 0.008089323f, 0.007359131f, 0.006691736f, 0.006083223f, 0.005529423f, 0.005025504f, 0.004566879f, 0.004149405f, 0.003769336f, 0.003423302f, 0.003108313f, 0.00282165f, 0.00256083f, 0.002323578f, 0.002107847f, 0.001911867f, 0.001734006f, 0.001572736f, 0.001426627f, 0.001294325f, 0.001174475f, 0.001065842f, 0.000967322f, 0.000877926f, 0.000796785f, 0.00072315f, 0.00065635f, 0.000595768f, 0.000540839f, 0.000491044f, 0.000445905f, 0.000404983f, 0.000367882f, 0.000334243f, 0.000303741f, 0.000276081f, 0.000250997f, 0.000228247f, 0.000207613f, 0.000188895f, 0.000171913f, 0.000156503f, 0.000142518f, 0.000129823f, 0.000118297f, 0.000107831f, 9.83246E-05f, 8.96879E-05f, 8.18395E-05f, 7.47058E-05f, 6.82199E-05f, 6.23213E-05f, 5.69553E-05f, 5.20725E-05f, 4.76278E-05f, 4.35808E-05f, 3.98947E-05f, 3.65361E-05f, 3.3475E-05f, 0.000030684f, 2.81384E-05f, 2.58157E-05f, 2.36957E-05f, 2.176E-05f, 1.99918E-05f, 1.8376E-05f, 1.6899E-05f, 1.55482E-05f, 1.43123E-05f, 1.31812E-05f, 1.21455E-05f, 1.11967E-05f, 1.03273E-05f, 9.53013E-06f, 8.79898E-06f, 8.12807E-06f, 7.51216E-06f, 6.94651E-06f, 6.42678E-06f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f };
        }

        private static Lazy<_Cie1931XYZ> _cie1931XYZ = new Lazy<_Cie1931XYZ>(isThreadSafe: false);
        public static XYZ Cie1931XYZ => _cie1931XYZ.Value;

        /// <summary>
        /// CIE (1931) 2-deg colour matching functions.
        /// </summary>
        /// <remarks>
        /// The CIE 1931 2-deg CMFs (CIE, 1932), which form the basis for most practical colorimetry, are based on the chromaticity coordinates obtained by Guild (1931) and by Wright (1928).
        /// Chromaticity coordinates, however, provide only a relative measure of the ratios of the three primaries needed to match each spectrum color, whereas CMFs specify absolute energy values.
        /// In order to reconstruct the CMFs from the Wright and Guild data, it was assumed that the CIE1924 V(l) photopic luminosity function (CIE, 1926) is a linear combination of the three CMFs (see Wyszecki & Stiles, 1982), for a description of the reconstruction and for the tabulated values. 
        /// It has long been clear that the CIE1924 V(λ) that was used to construct the CIE 1931 2-deg CMFs seriously underestimates sensitivity at wavelengths below 460 nm, so that these CMFs are seriously in error at short wavelengths. 
        /// The <see cref="Judd1951XYZ">Judd</see> and <see cref="JuddVos1978XYZ">Judd-Vos</see> modifications are attempts to overcome this problem. 
        /// See also Table I (3.3.1) of Wyszecki & Stiles (1982). 
        /// </remarks>
        internal class _Cie1931XYZ : XYZ
        {
            public const int Degrees = 2;

            public override int StepNanometers => 1;
            public override int FirstNanometers => 360;
            public override int LastNanometers => 830;

            protected override float[] SamplesX => X;
            protected override float[] SamplesY => Y;
            protected override float[] SamplesZ => Z;

            /// <summary>
            /// x̄(λ). 1 nm steps from 360 to 830.
            /// </summary>
            public static readonly float[] X = { 0.0001299f, 0.000145847f, 0.000163802f, 0.000184004f, 0.00020669f, 0.0002321f, 0.000260728f, 0.000293075f, 0.000329388f, 0.000369914f, 0.0004149f, 0.000464159f, 0.000518986f, 0.000581854f, 0.000655235f, 0.0007416f, 0.00084503f, 0.000964527f, 0.001094949f, 0.001231154f, 0.001368f, 0.00150205f, 0.001642328f, 0.001802382f, 0.001995757f, 0.002236f, 0.002535385f, 0.002892603f, 0.003300829f, 0.003753236f, 0.004243f, 0.004762389f, 0.005330048f, 0.005978712f, 0.006741117f, 0.00765f, 0.008751373f, 0.01002888f, 0.0114217f, 0.01286901f, 0.01431f, 0.01570443f, 0.01714744f, 0.01878122f, 0.02074801f, 0.02319f, 0.02620736f, 0.02978248f, 0.03388092f, 0.03846824f, 0.04351f, 0.0489956f, 0.0550226f, 0.0617188f, 0.069212f, 0.07763f, 0.08695811f, 0.09717672f, 0.1084063f, 0.1207672f, 0.13438f, 0.1493582f, 0.1653957f, 0.1819831f, 0.198611f, 0.21477f, 0.2301868f, 0.2448797f, 0.2587773f, 0.2718079f, 0.2839f, 0.2949438f, 0.3048965f, 0.3137873f, 0.3216454f, 0.3285f, 0.3343513f, 0.3392101f, 0.3431213f, 0.3461296f, 0.34828f, 0.3495999f, 0.3501474f, 0.350013f, 0.349287f, 0.34806f, 0.3463733f, 0.3442624f, 0.3418088f, 0.3390941f, 0.3362f, 0.3331977f, 0.3300411f, 0.3266357f, 0.3228868f, 0.3187f, 0.3140251f, 0.308884f, 0.3032904f, 0.2972579f, 0.2908f, 0.2839701f, 0.2767214f, 0.2689178f, 0.2604227f, 0.2511f, 0.2408475f, 0.2298512f, 0.2184072f, 0.2068115f, 0.19536f, 0.1842136f, 0.1733273f, 0.1626881f, 0.1522833f, 0.1421f, 0.1321786f, 0.1225696f, 0.1132752f, 0.1042979f, 0.09564f, 0.08729955f, 0.07930804f, 0.07171776f, 0.06458099f, 0.05795001f, 0.05186211f, 0.04628152f, 0.04115088f, 0.03641283f, 0.03201f, 0.0279172f, 0.0241444f, 0.020687f, 0.0175404f, 0.0147f, 0.01216179f, 0.00991996f, 0.00796724f, 0.006296346f, 0.0049f, 0.003777173f, 0.00294532f, 0.00242488f, 0.002236293f, 0.0024f, 0.00292552f, 0.00383656f, 0.00517484f, 0.00698208f, 0.0093f, 0.01214949f, 0.01553588f, 0.01947752f, 0.02399277f, 0.0291f, 0.03481485f, 0.04112016f, 0.04798504f, 0.05537861f, 0.06327f, 0.07163501f, 0.08046224f, 0.08973996f, 0.09945645f, 0.1096f, 0.1201674f, 0.1311145f, 0.1423679f, 0.1538542f, 0.1655f, 0.1772571f, 0.18914f, 0.2011694f, 0.2133658f, 0.2257499f, 0.2383209f, 0.2510668f, 0.2639922f, 0.2771017f, 0.2904f, 0.3038912f, 0.3175726f, 0.3314384f, 0.3454828f, 0.3597f, 0.3740839f, 0.3886396f, 0.4033784f, 0.4183115f, 0.4334499f, 0.4487953f, 0.464336f, 0.480064f, 0.4959713f, 0.5120501f, 0.5282959f, 0.5446916f, 0.5612094f, 0.5778215f, 0.5945f, 0.6112209f, 0.6279758f, 0.6447602f, 0.6615697f, 0.6784f, 0.6952392f, 0.7120586f, 0.7288284f, 0.7455188f, 0.7621f, 0.7785432f, 0.7948256f, 0.8109264f, 0.8268248f, 0.8425f, 0.8579325f, 0.8730816f, 0.8878944f, 0.9023181f, 0.9163f, 0.9297995f, 0.9427984f, 0.9552776f, 0.9672179f, 0.9786f, 0.9893856f, 0.9995488f, 1.0090892f, 1.0180064f, 1.0263f, 1.0339827f, 1.040986f, 1.047188f, 1.0524667f, 1.0567f, 1.0597944f, 1.0617992f, 1.0628068f, 1.0629096f, 1.0622f, 1.0607352f, 1.0584436f, 1.0552244f, 1.0509768f, 1.0456f, 1.0390369f, 1.0313608f, 1.0226662f, 1.0130477f, 1.0026f, 0.9913675f, 0.9793314f, 0.9664916f, 0.9528479f, 0.9384f, 0.923194f, 0.907244f, 0.890502f, 0.87292f, 0.8544499f, 0.835084f, 0.814946f, 0.794186f, 0.772954f, 0.7514f, 0.7295836f, 0.7075888f, 0.6856022f, 0.6638104f, 0.6424f, 0.6215149f, 0.6011138f, 0.5811052f, 0.5613977f, 0.5419f, 0.5225995f, 0.5035464f, 0.4847436f, 0.4661939f, 0.4479f, 0.4298613f, 0.412098f, 0.394644f, 0.3775333f, 0.3608f, 0.3444563f, 0.3285168f, 0.3130192f, 0.2980011f, 0.2835f, 0.2695448f, 0.2561184f, 0.2431896f, 0.2307272f, 0.2187f, 0.2070971f, 0.1959232f, 0.1851708f, 0.1748323f, 0.1649f, 0.1553667f, 0.14623f, 0.13749f, 0.1291467f, 0.1212f, 0.1136397f, 0.106465f, 0.09969044f, 0.09333061f, 0.0874f, 0.08190096f, 0.07680428f, 0.07207712f, 0.06768664f, 0.0636f, 0.05980685f, 0.05628216f, 0.05297104f, 0.04981861f, 0.04677f, 0.04378405f, 0.04087536f, 0.03807264f, 0.03540461f, 0.0329f, 0.03056419f, 0.02838056f, 0.02634484f, 0.02445275f, 0.0227f, 0.02108429f, 0.01959988f, 0.01823732f, 0.01698717f, 0.01584f, 0.01479064f, 0.01383132f, 0.01294868f, 0.0121292f, 0.01135916f, 0.01062935f, 0.009938846f, 0.009288422f, 0.008678854f, 0.008110916f, 0.007582388f, 0.007088746f, 0.006627313f, 0.006195408f, 0.005790346f, 0.005409826f, 0.005052583f, 0.004717512f, 0.004403507f, 0.004109457f, 0.003833913f, 0.003575748f, 0.003334342f, 0.003109075f, 0.002899327f, 0.002704348f, 0.00252302f, 0.002354168f, 0.002196616f, 0.00204919f, 0.00191096f, 0.001781438f, 0.00166011f, 0.001546459f, 0.001439971f, 0.001340042f, 0.001246275f, 0.001158471f, 0.00107643f, 0.000999949f, 0.000928736f, 0.000862433f, 0.00080075f, 0.000743396f, 0.000690079f, 0.000640516f, 0.000594502f, 0.000551865f, 0.000512429f, 0.000476021f, 0.000442454f, 0.000411512f, 0.000382981f, 0.000356649f, 0.000332301f, 0.000309759f, 0.000288887f, 0.000269539f, 0.000251568f, 0.000234826f, 0.000219171f, 0.000204526f, 0.000190841f, 0.000178065f, 0.000166151f, 0.000155024f, 0.000144622f, 0.00013491f, 0.000125852f, 0.000117413f, 0.000109552f, 0.000102225f, 9.53945E-05f, 8.90239E-05f, 8.30753E-05f, 7.75127E-05f, 7.2313E-05f, 6.74578E-05f, 6.29284E-05f, 5.87065E-05f, 5.47703E-05f, 5.10992E-05f, 4.76765E-05f, 4.44857E-05f, 4.15099E-05f, 3.87332E-05f, 3.6142E-05f, 3.37235E-05f, 3.14649E-05f, 2.93533E-05f, 2.73757E-05f, 2.55243E-05f, 2.37938E-05f, 2.21787E-05f, 2.06738E-05f, 1.92723E-05f, 1.79664E-05f, 1.67499E-05f, 1.56165E-05f, 1.45598E-05f, 1.35739E-05f, 1.26544E-05f, 1.17972E-05f, 1.09984E-05f, 1.0254E-05f, 9.55965E-06f, 8.91204E-06f, 8.30836E-06f, 7.74577E-06f, 7.22146E-06f, 6.73248E-06f, 6.27642E-06f, 5.8513E-06f, 5.45512E-06f, 5.08587E-06f, 4.74147E-06f, 4.42024E-06f, 4.12078E-06f, 3.84172E-06f, 3.58165E-06f, 3.33913E-06f, 3.11295E-06f, 2.90212E-06f, 2.70565E-06f, 2.52253E-06f, 2.35173E-06f, 2.19242E-06f, 2.0439E-06f, 1.9055E-06f, 1.77651E-06f, 1.65622E-06f, 1.54402E-06f, 1.43944E-06f, 1.34198E-06f, 1.25114E-06f };
            /// <summary>
            /// ȳ(λ). 1 nm steps from 360 to 830.
            /// </summary>
            public static readonly float[] Y = { 0.000003917f, 4.39358E-06f, 4.9296E-06f, 5.53214E-06f, 6.20825E-06f, 0.000006965f, 7.81322E-06f, 8.76734E-06f, 9.83984E-06f, 1.10432E-05f, 0.00001239f, 1.38864E-05f, 1.55573E-05f, 1.7443E-05f, 1.95838E-05f, 0.00002202f, 2.48397E-05f, 2.80413E-05f, 3.1531E-05f, 3.52152E-05f, 0.000039f, 4.28264E-05f, 4.69146E-05f, 5.15896E-05f, 5.71764E-05f, 0.000064f, 7.23442E-05f, 8.22122E-05f, 9.35082E-05f, 0.000106136f, 0.00012f, 0.000134984f, 0.000151492f, 0.000170208f, 0.000191816f, 0.000217f, 0.000246907f, 0.00028124f, 0.00031852f, 0.000357267f, 0.000396f, 0.000433715f, 0.000473024f, 0.000517876f, 0.000572219f, 0.00064f, 0.00072456f, 0.0008255f, 0.00094116f, 0.00106988f, 0.00121f, 0.001362091f, 0.001530752f, 0.001720368f, 0.001935323f, 0.00218f, 0.0024548f, 0.002764f, 0.0031178f, 0.0035264f, 0.004f, 0.00454624f, 0.00515932f, 0.00582928f, 0.00654616f, 0.0073f, 0.008086507f, 0.00890872f, 0.00976768f, 0.01066443f, 0.0116f, 0.01257317f, 0.01358272f, 0.01462968f, 0.01571509f, 0.01684f, 0.01800736f, 0.01921448f, 0.02045392f, 0.02171824f, 0.023f, 0.02429461f, 0.02561024f, 0.02695857f, 0.02835125f, 0.0298f, 0.03131083f, 0.03288368f, 0.03452112f, 0.03622571f, 0.038f, 0.03984667f, 0.041768f, 0.043766f, 0.04584267f, 0.048f, 0.05024368f, 0.05257304f, 0.05498056f, 0.05745872f, 0.06f, 0.06260197f, 0.06527752f, 0.06804208f, 0.07091109f, 0.0739f, 0.077016f, 0.0802664f, 0.0836668f, 0.0872328f, 0.09098f, 0.09491755f, 0.09904584f, 0.1033674f, 0.1078846f, 0.1126f, 0.117532f, 0.1226744f, 0.1279928f, 0.1334528f, 0.13902f, 0.1446764f, 0.1504693f, 0.1564619f, 0.1627177f, 0.1693f, 0.1762431f, 0.1835581f, 0.1912735f, 0.199418f, 0.20802f, 0.2171199f, 0.2267345f, 0.2368571f, 0.2474812f, 0.2586f, 0.2701849f, 0.2822939f, 0.2950505f, 0.308578f, 0.323f, 0.3384021f, 0.3546858f, 0.3716986f, 0.3892875f, 0.4073f, 0.4256299f, 0.4443096f, 0.4633944f, 0.4829395f, 0.503f, 0.5235693f, 0.544512f, 0.56569f, 0.5869653f, 0.6082f, 0.6293456f, 0.6503068f, 0.6708752f, 0.6908424f, 0.71f, 0.7281852f, 0.7454636f, 0.7619694f, 0.7778368f, 0.7932f, 0.8081104f, 0.8224962f, 0.8363068f, 0.8494916f, 0.862f, 0.8738108f, 0.8849624f, 0.8954936f, 0.9054432f, 0.9148501f, 0.9237348f, 0.9320924f, 0.9399226f, 0.9472252f, 0.954f, 0.9602561f, 0.9660074f, 0.9712606f, 0.9760225f, 0.9803f, 0.9840924f, 0.9874182f, 0.9903128f, 0.9928116f, 0.9949501f, 0.9967108f, 0.9980983f, 0.999112f, 0.9997482f, 1f, 0.9998567f, 0.9993046f, 0.9983255f, 0.9968987f, 0.995f, 0.9926005f, 0.9897426f, 0.9864444f, 0.9827241f, 0.9786f, 0.9740837f, 0.9691712f, 0.9638568f, 0.9581349f, 0.952f, 0.9454504f, 0.9384992f, 0.9311628f, 0.9234576f, 0.9154f, 0.9070064f, 0.8982772f, 0.8892048f, 0.8797816f, 0.87f, 0.8598613f, 0.849392f, 0.838622f, 0.8275813f, 0.8163f, 0.8047947f, 0.793082f, 0.781192f, 0.7691547f, 0.757f, 0.7447541f, 0.7324224f, 0.7200036f, 0.7074965f, 0.6949f, 0.6822192f, 0.6694716f, 0.6566744f, 0.6438448f, 0.631f, 0.6181555f, 0.6053144f, 0.5924756f, 0.5796379f, 0.5668f, 0.5539611f, 0.5411372f, 0.5283528f, 0.5156323f, 0.503f, 0.4904688f, 0.4780304f, 0.4656776f, 0.4534032f, 0.4412f, 0.42908f, 0.417036f, 0.405032f, 0.393032f, 0.381f, 0.3689184f, 0.3568272f, 0.3447768f, 0.3328176f, 0.321f, 0.3093381f, 0.2978504f, 0.2865936f, 0.2756245f, 0.265f, 0.2547632f, 0.2448896f, 0.2353344f, 0.2260528f, 0.217f, 0.2081616f, 0.1995488f, 0.1911552f, 0.1829744f, 0.175f, 0.1672235f, 0.1596464f, 0.1522776f, 0.1451259f, 0.1382f, 0.1315003f, 0.1250248f, 0.1187792f, 0.1127691f, 0.107f, 0.1014762f, 0.09618864f, 0.09112296f, 0.08626485f, 0.0816f, 0.07712064f, 0.07282552f, 0.06871008f, 0.06476976f, 0.061f, 0.05739621f, 0.05395504f, 0.05067376f, 0.04754965f, 0.04458f, 0.04175872f, 0.03908496f, 0.03656384f, 0.03420048f, 0.032f, 0.02996261f, 0.02807664f, 0.02632936f, 0.02470805f, 0.0232f, 0.02180077f, 0.02050112f, 0.01928108f, 0.01812069f, 0.017f, 0.01590379f, 0.01483718f, 0.01381068f, 0.01283478f, 0.01192f, 0.01106831f, 0.01027339f, 0.009533311f, 0.008846157f, 0.00821f, 0.007623781f, 0.007085424f, 0.006591476f, 0.006138485f, 0.005723f, 0.005343059f, 0.004995796f, 0.004676404f, 0.004380075f, 0.004102f, 0.003838453f, 0.003589099f, 0.003354219f, 0.003134093f, 0.002929f, 0.002738139f, 0.002559876f, 0.002393244f, 0.002237275f, 0.002091f, 0.001953587f, 0.00182458f, 0.00170358f, 0.001590187f, 0.001484f, 0.001384496f, 0.001291268f, 0.001204092f, 0.001122744f, 0.001047f, 0.00097659f, 0.000911109f, 0.000850133f, 0.000793238f, 0.00074f, 0.000690083f, 0.00064331f, 0.000599496f, 0.000558455f, 0.00052f, 0.000483914f, 0.000450053f, 0.000418345f, 0.000388718f, 0.0003611f, 0.000335384f, 0.00031144f, 0.000289166f, 0.000268454f, 0.0002492f, 0.000231302f, 0.000214686f, 0.000199288f, 0.000185048f, 0.0001719f, 0.000159778f, 0.000148604f, 0.000138302f, 0.000128793f, 0.00012f, 0.00011186f, 0.000104322f, 9.73356E-05f, 9.08459E-05f, 0.0000848f, 7.91467E-05f, 0.000073858f, 0.000068916f, 6.43027E-05f, 0.00006f, 5.59819E-05f, 5.22256E-05f, 4.87184E-05f, 4.54475E-05f, 0.0000424f, 3.9561E-05f, 3.69151E-05f, 3.44487E-05f, 3.21482E-05f, 0.00003f, 2.79913E-05f, 2.61136E-05f, 2.43602E-05f, 2.27246E-05f, 0.0000212f, 1.97786E-05f, 1.84529E-05f, 1.72169E-05f, 1.60646E-05f, 0.00001499f, 1.39873E-05f, 1.30516E-05f, 1.21782E-05f, 1.13625E-05f, 0.0000106f, 9.88588E-06f, 9.2173E-06f, 8.59236E-06f, 8.00913E-06f, 7.4657E-06f, 6.95957E-06f, 6.488E-06f, 6.0487E-06f, 5.6394E-06f, 5.2578E-06f, 4.90177E-06f, 4.56972E-06f, 4.26019E-06f, 3.97174E-06f, 3.7029E-06f, 3.45216E-06f, 3.2183E-06f, 3.0003E-06f, 2.79714E-06f, 2.6078E-06f, 2.43122E-06f, 2.26653E-06f, 2.11301E-06f, 1.96994E-06f, 1.8366E-06f, 1.71223E-06f, 1.59623E-06f, 1.48809E-06f, 1.38731E-06f, 1.2934E-06f, 1.20582E-06f, 1.12414E-06f, 1.04801E-06f, 9.77058E-07f, 9.1093E-07f, 8.49251E-07f, 7.91721E-07f, 7.3809E-07f, 6.8811E-07f, 6.4153E-07f, 5.9809E-07f, 5.57575E-07f, 5.19808E-07f, 4.84612E-07f, 4.5181E-07f };
            /// <summary>
            /// z̄(λ). 1 nm steps from 360 to 830.
            /// </summary>
            public static readonly float[] Z = { 0.0006061f, 0.000680879f, 0.000765146f, 0.000860012f, 0.000966593f, 0.001086f, 0.001220586f, 0.001372729f, 0.001543579f, 0.001734286f, 0.001946f, 0.002177777f, 0.002435809f, 0.002731953f, 0.003078064f, 0.003486f, 0.003975227f, 0.00454088f, 0.00515832f, 0.005802907f, 0.006450001f, 0.007083216f, 0.007745488f, 0.008501152f, 0.009414544f, 0.01054999f, 0.0119658f, 0.01365587f, 0.01558805f, 0.01773015f, 0.02005001f, 0.02251136f, 0.02520288f, 0.02827972f, 0.03189704f, 0.03621f, 0.04143771f, 0.04750372f, 0.05411988f, 0.06099803f, 0.06785001f, 0.07448632f, 0.08136156f, 0.08915364f, 0.09854048f, 0.1102f, 0.1246133f, 0.1417017f, 0.1613035f, 0.1832568f, 0.2074f, 0.2336921f, 0.2626114f, 0.2947746f, 0.3307985f, 0.3713f, 0.4162091f, 0.4654642f, 0.5196948f, 0.5795303f, 0.6456f, 0.7184838f, 0.7967133f, 0.8778459f, 0.959439f, 1.0390501f, 1.1153673f, 1.1884971f, 1.2581233f, 1.3239296f, 1.3856f, 1.4426352f, 1.4948035f, 1.5421903f, 1.5848807f, 1.62296f, 1.6564048f, 1.6852959f, 1.7098745f, 1.7303821f, 1.74706f, 1.7600446f, 1.7696233f, 1.7762637f, 1.7804334f, 1.7826f, 1.7829682f, 1.7816998f, 1.7791982f, 1.7758671f, 1.77211f, 1.7682589f, 1.764039f, 1.7589438f, 1.7524663f, 1.7441f, 1.7335595f, 1.7208581f, 1.7059369f, 1.6887372f, 1.6692f, 1.6475287f, 1.6234127f, 1.5960223f, 1.564528f, 1.5281f, 1.4861114f, 1.4395215f, 1.3898799f, 1.3387362f, 1.28764f, 1.2374223f, 1.1878243f, 1.1387611f, 1.090148f, 1.0419f, 0.9941976f, 0.9473473f, 0.9014531f, 0.8566193f, 0.8129501f, 0.7705173f, 0.7294448f, 0.6899136f, 0.6521049f, 0.6162f, 0.5823286f, 0.5504162f, 0.5203376f, 0.4919673f, 0.46518f, 0.4399246f, 0.4161836f, 0.3938822f, 0.3729459f, 0.3533f, 0.3348578f, 0.3175521f, 0.3013375f, 0.2861686f, 0.272f, 0.2588171f, 0.2464838f, 0.2347718f, 0.2234533f, 0.2123f, 0.2011692f, 0.1901196f, 0.1792254f, 0.1685608f, 0.1582f, 0.1481383f, 0.1383758f, 0.1289942f, 0.1200751f, 0.1117f, 0.1039048f, 0.09666748f, 0.08998272f, 0.08384531f, 0.07824999f, 0.07320899f, 0.06867816f, 0.06456784f, 0.06078835f, 0.05725001f, 0.05390435f, 0.05074664f, 0.04775276f, 0.04489859f, 0.04216f, 0.03950728f, 0.03693564f, 0.03445836f, 0.03208872f, 0.02984f, 0.02771181f, 0.02569444f, 0.02378716f, 0.02198925f, 0.0203f, 0.01871805f, 0.01724036f, 0.01586364f, 0.01458461f, 0.0134f, 0.01230723f, 0.01130188f, 0.01037792f, 0.009529306f, 0.008749999f, 0.0080352f, 0.0073816f, 0.0067854f, 0.0062428f, 0.005749999f, 0.0053036f, 0.0048998f, 0.0045342f, 0.0042024f, 0.0039f, 0.0036232f, 0.0033706f, 0.0031414f, 0.0029348f, 0.002749999f, 0.0025852f, 0.0024386f, 0.0023094f, 0.0021968f, 0.0021f, 0.002017733f, 0.0019482f, 0.0018898f, 0.001840933f, 0.0018f, 0.001766267f, 0.0017378f, 0.0017112f, 0.001683067f, 0.001650001f, 0.001610133f, 0.0015644f, 0.0015136f, 0.001458533f, 0.0014f, 0.001336667f, 0.00127f, 0.001205f, 0.001146667f, 0.0011f, 0.0010688f, 0.0010494f, 0.0010356f, 0.0010212f, 0.001f, 0.00096864f, 0.00092992f, 0.00088688f, 0.00084256f, 0.0008f, 0.00076096f, 0.00072368f, 0.00068592f, 0.00064544f, 0.0006f, 0.000547867f, 0.0004916f, 0.0004354f, 0.000383467f, 0.00034f, 0.000307253f, 0.00028316f, 0.00026544f, 0.000251813f, 0.00024f, 0.000229547f, 0.00022064f, 0.00021196f, 0.000202187f, 0.00019f, 0.000174213f, 0.00015564f, 0.00013596f, 0.000116853f, 0.0001f, 8.61333E-05f, 0.0000746f, 0.000065f, 5.69333E-05f, 5E-05f, 0.00004416f, 0.00003948f, 0.00003572f, 0.00003264f, 0.00003f, 2.76533E-05f, 0.00002556f, 0.00002364f, 2.18133E-05f, 0.00002f, 1.81333E-05f, 0.0000162f, 0.0000142f, 1.21333E-05f, 0.00001f, 7.73333E-06f, 0.0000054f, 0.0000032f, 1.33333E-06f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f };
        }

        private static Lazy<_Judd1951XYZ> _judd1951XYZ = new Lazy<_Judd1951XYZ>(isThreadSafe: false);
        public static XYZ Judd1951XYZ => _judd1951XYZ.Value;

        /// <summary>
        /// Judd-modified CIE 2-deg colour matching functions (1951).
        /// </summary>
        /// <remarks>
        /// It has long been clear that the CIE 1924 V(λ) function (CIE, 1926) that was used to construct the CIE 1931 2-deg CMFs (CIE, 1931) seriously underestimates sensitivity at wavelengths below 460 nm. 
        /// Judd (1951) proposed a revised version of V(λ) to overcome this problem, and derived a new set of CMFs. 
        /// Yet, like the CIE 1931 CMFs, the Judd-modified functions are reconstructed using the V(λ) function. 
        /// From Table 1 (5.5.2) of Wyszecki and Stiles (1982). 
        /// </remarks>
        internal class _Judd1951XYZ : XYZ
        {
            public const int Degrees = 2;

            public override int StepNanometers => 10;
            public override int FirstNanometers => 370;
            public override int LastNanometers => 770;

            protected override float[] SamplesX => X;
            protected override float[] SamplesY => Y;
            protected override float[] SamplesZ => Z;

            /// <summary>
            /// x̄(λ). 10 nm steps from 370 to 770.
            /// </summary>
            public static readonly float[] X = { 0.0008f, 0.0045f, 0.0201f, 0.0611f, 0.1267f, 0.2285f, 0.3081f, 0.3312f, 0.2888f, 0.2323f, 0.1745f, 0.092f, 0.0318f, 0.0048f, 0.0093f, 0.0636f, 0.1668f, 0.2926f, 0.4364f, 0.597f, 0.7642f, 0.9159f, 1.0225f, 1.0544f, 0.9922f, 0.8432f, 0.6327f, 0.4404f, 0.2787f, 0.1619f, 0.0858f, 0.0459f, 0.0222f, 0.0113f, 0.0057f, 0.0028f, 0.0015f, 0.0005f, 0.0003f, 0.0002f, 0.0001f };
            /// <summary>
            /// ȳ(λ). 10 nm steps from 370 to 770.
            /// </summary>
            public static readonly float[] Y = { 0.0001f, 0.0004f, 0.0015f, 0.0045f, 0.0093f, 0.0175f, 0.0273f, 0.0379f, 0.0468f, 0.06f, 0.091f, 0.139f, 0.208f, 0.323f, 0.503f, 0.71f, 0.862f, 0.954f, 0.995f, 0.995f, 0.952f, 0.87f, 0.757f, 0.631f, 0.503f, 0.381f, 0.265f, 0.175f, 0.107f, 0.061f, 0.032f, 0.017f, 0.0082f, 0.0041f, 0.0021f, 0.0011f, 0.0005f, 0.0002f, 0.0001f, 0.0001f, 0f };
            /// <summary>
            /// z̄(λ). 10 nm steps from 370 to 770.
            /// </summary>
            public static readonly float[] Z = { 0.0046f, 0.0224f, 0.0925f, 0.2799f, 0.5835f, 1.0622f, 1.4526f, 1.6064f, 1.4717f, 1.288f, 1.1133f, 0.7552f, 0.4461f, 0.2644f, 0.1541f, 0.0763f, 0.0412f, 0.02f, 0.0088f, 0.0039f, 0.002f, 0.0016f, 0.0011f, 0.0007f, 0.0003f, 0.0002f, 0.0001f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f };
        }

        private static Lazy<_JuddVos1978XYZ> _juddVos1978XYZ = new Lazy<_JuddVos1978XYZ>(isThreadSafe: false);
        public static XYZ JuddVos1978XYZ => _juddVos1978XYZ.Value;

        /// <summary>
        /// Judd-Vos-modified CIE 2-deg colour matching functions (1978).
        /// </summary>
        /// <remarks>
        /// In 1978, Vos made additional corrections to Judd's (1951) revision of the CIE 1931 2 deg color matching functions (CIE, 1932) and incorporated the infra-red color reversal described by Brindley (1955).
        /// The Judd-Vos V(λ) is the modified luminosity function VM(λ) recently adopted by the CIE. 
        /// From Table 1 of Vos (1978). See also Table I (5.5.2) of Wyszecki and Stiles (1982). 
        /// </remarks>
        internal class _JuddVos1978XYZ : XYZ
        {
            public const int Degrees = 2;

            public override int StepNanometers => 5;
            public override int FirstNanometers => 380;
            public override int LastNanometers => 825;

            protected override float[] SamplesX => X;
            protected override float[] SamplesY => Y;
            protected override float[] SamplesZ => Z;

            /// <summary>
            /// x̄(λ). 5 nm steps from 380 to 825.
            /// </summary>
            public static readonly float[] X = { 0.0026899f, 0.0053105f, 0.010781f, 0.020792f, 0.037981f, 0.063157f, 0.099941f, 0.15824f, 0.22948f, 0.28108f, 0.31095f, 0.33072f, 0.33336f, 0.31672f, 0.28882f, 0.25969f, 0.23276f, 0.20999f, 0.17476f, 0.13287f, 0.091944f, 0.056985f, 0.031731f, 0.014613f, 0.0048491f, 0.0023215f, 0.0092899f, 0.029278f, 0.063791f, 0.11081f, 0.16692f, 0.22768f, 0.29269f, 0.36225f, 0.43635f, 0.51513f, 0.59748f, 0.68121f, 0.76425f, 0.84394f, 0.91635f, 0.97703f, 1.023f, 1.0513f, 1.055f, 1.0362f, 0.99239f, 0.92861f, 0.84346f, 0.73983f, 0.63289f, 0.53351f, 0.44062f, 0.35453f, 0.27862f, 0.21485f, 0.16161f, 0.1182f, 0.085753f, 0.063077f, 0.045834f, 0.032057f, 0.022187f, 0.015612f, 0.011098f, 0.0079233f, 0.0056531f, 0.0040039f, 0.0028253f, 0.0019947f, 0.0013994f, 0.0009698f, 0.00066847f, 0.00046141f, 0.00032073f, 0.00022573f, 0.00015973f, 0.00011275f, 0.000079513f, 0.000056087f, 0.000039541f, 0.000027852f, 0.000019597f, 0.00001377f, 0.00000967f, 6.7918E-06f, 4.7706E-06f, 0.000003355f, 2.3534E-06f, 1.6377E-06f };
            /// <summary>
            /// ȳ(λ). 5 nm steps from 380 to 825.
            /// </summary>
            public static readonly float[] Y = { 0.0002f, 0.00039556f, 0.0008f, 0.0015457f, 0.0028f, 0.0046562f, 0.0074f, 0.011779f, 0.0175f, 0.022678f, 0.0273f, 0.032584f, 0.0379f, 0.042391f, 0.0468f, 0.052122f, 0.06f, 0.072942f, 0.09098f, 0.11284f, 0.13902f, 0.16987f, 0.20802f, 0.25808f, 0.323f, 0.4054f, 0.503f, 0.60811f, 0.71f, 0.7951f, 0.862f, 0.91505f, 0.954f, 0.98004f, 0.99495f, 1.0001f, 0.995f, 0.97875f, 0.952f, 0.91558f, 0.87f, 0.81623f, 0.757f, 0.69483f, 0.631f, 0.56654f, 0.503f, 0.44172f, 0.381f, 0.32052f, 0.265f, 0.21702f, 0.175f, 0.13812f, 0.107f, 0.081652f, 0.061f, 0.044327f, 0.032f, 0.023454f, 0.017f, 0.011872f, 0.00821f, 0.0057723f, 0.004102f, 0.0029291f, 0.002091f, 0.0014822f, 0.001047f, 0.00074015f, 0.00052f, 0.00036093f, 0.0002492f, 0.00017231f, 0.00012f, 0.00008462f, 0.00006f, 0.000042446f, 0.00003f, 0.00002121f, 0.000014989f, 0.000010584f, 7.4656E-06f, 5.2592E-06f, 3.7028E-06f, 2.6076E-06f, 1.8365E-06f, 0.000001295f, 9.1092E-07f, 6.3564E-07f };
            /// <summary>
            /// z̄(λ). 5 nm steps from 380 to 825.
            /// </summary>
            public static readonly float[] Z = { 0.01226f, 0.024222f, 0.04925f, 0.095135f, 0.17409f, 0.29013f, 0.46053f, 0.73166f, 1.0658f, 1.3146f, 1.4672f, 1.5796f, 1.6166f, 1.5682f, 1.4717f, 1.374f, 1.2917f, 1.2356f, 1.1138f, 0.9422f, 0.75596f, 0.5864f, 0.44669f, 0.34116f, 0.26437f, 0.20594f, 0.15445f, 0.10918f, 0.076585f, 0.056227f, 0.041366f, 0.029353f, 0.020042f, 0.013312f, 0.0087823f, 0.0058573f, 0.0040493f, 0.0029217f, 0.0022771f, 0.0019706f, 0.0018066f, 0.0015449f, 0.0012348f, 0.0011177f, 0.00090564f, 0.00069467f, 0.00042885f, 0.00031817f, 0.00025598f, 0.00015679f, 0.000097694f, 0.000068944f, 0.000051165f, 0.000036016f, 0.000024238f, 0.000016915f, 0.000011906f, 8.1489E-06f, 5.6006E-06f, 3.9544E-06f, 2.7912E-06f, 1.9176E-06f, 1.3135E-06f, 9.1519E-07f, 6.4767E-07f, 4.6352E-07f, 3.3304E-07f, 2.3823E-07f, 1.7026E-07f, 1.2207E-07f, 8.7107E-08f, 6.1455E-08f, 4.3162E-08f, 3.0379E-08f, 2.1554E-08f, 1.5493E-08f, 1.1204E-08f, 8.0873E-09f, 5.834E-09f, 4.211E-09f, 3.0383E-09f, 2.1907E-09f, 1.5778E-09f, 1.1348E-09f, 8.1565E-10f, 5.8626E-10f, 4.2138E-10f, 3.0319E-10f, 2.1753E-10f, 1.5476E-10f };
        }

        private static Lazy<_Cie1964XYZ> _cie1964XYZ = new Lazy<_Cie1964XYZ>(isThreadSafe: false);
        public static XYZ Cie1964XYZ => _cie1964XYZ.Value;

        /// <summary>
        /// CIE (1964) 10-deg colour matching functions.
        /// </summary>
        /// <remarks>
        /// The CIE 1964 standard observer is based on the mean 10-deg color matching functions of Stiles & Burch (1959) and of Speranskaya (1959).
        /// In averaging the functions together, the Speranskaya were given a low weight, particularly at the spectral extremes, so that the final functions are dominated by those of Stiles & Burch.
        /// From Table I (3.3.2) of Wyszecki & Stiles (1982). 
        /// The 10-deg CMFs reflect a lower macular pigment density than the 2-deg functions, since macular pigmentation declines with eccentricity.
        /// They also reflect a narrowing of the underlying cone spectral sensitivities, since cones become shorter and broader with increasing eccentricity, thus reducing the axial optical pigment density in the cone outer segment. 
        /// </remarks>
        private class _Cie1964XYZ : XYZ
        {
            public const int Degrees = 10;
            
            public override int StepNanometers => 1;
            public override int FirstNanometers => 360;
            public override int LastNanometers => 830;

            protected override float[] SamplesX => X;
            protected override float[] SamplesY => Y;
            protected override float[] SamplesZ => Z;

            /// <summary>
            /// x̄(λ). 1 nm steps from 360 to 830.
            /// </summary>
            public static readonly float[] X = { 1.222E-07f, 1.85138E-07f, 2.7883E-07f, 4.1747E-07f, 6.2133E-07f, 9.1927E-07f, 1.35198E-06f, 1.97654E-06f, 2.8725E-06f, 4.1495E-06f, 5.9586E-06f, 8.5056E-06f, 1.20686E-05f, 1.70226E-05f, 0.000023868f, 0.000033266f, 0.000046087f, 0.000063472f, 0.000086892f, 0.000118246f, 0.000159952f, 0.00021508f, 0.00028749f, 0.00038199f, 0.00050455f, 0.00066244f, 0.0008645f, 0.0011215f, 0.00144616f, 0.00185359f, 0.0023616f, 0.0029906f, 0.0037645f, 0.0047102f, 0.0058581f, 0.0072423f, 0.0088996f, 0.0108709f, 0.0131989f, 0.0159292f, 0.0191097f, 0.022788f, 0.027011f, 0.031829f, 0.037278f, 0.0434f, 0.050223f, 0.057764f, 0.066038f, 0.075033f, 0.084736f, 0.095041f, 0.105836f, 0.117066f, 0.128682f, 0.140638f, 0.152893f, 0.165416f, 0.178191f, 0.191214f, 0.204492f, 0.21765f, 0.230267f, 0.242311f, 0.253793f, 0.264737f, 0.275195f, 0.285301f, 0.295143f, 0.304869f, 0.314679f, 0.324355f, 0.33357f, 0.342243f, 0.350312f, 0.357719f, 0.364482f, 0.370493f, 0.375727f, 0.380158f, 0.383734f, 0.386327f, 0.387858f, 0.388396f, 0.387978f, 0.386726f, 0.384696f, 0.382006f, 0.378709f, 0.374915f, 0.370702f, 0.366089f, 0.361045f, 0.355518f, 0.349486f, 0.342957f, 0.335893f, 0.328284f, 0.32015f, 0.311475f, 0.302273f, 0.292858f, 0.283502f, 0.274044f, 0.264263f, 0.254085f, 0.243392f, 0.232187f, 0.220488f, 0.208198f, 0.195618f, 0.183034f, 0.170222f, 0.157348f, 0.14465f, 0.132349f, 0.120584f, 0.109456f, 0.099042f, 0.089388f, 0.080507f, 0.072034f, 0.06371f, 0.055694f, 0.048117f, 0.041072f, 0.034642f, 0.028896f, 0.023876f, 0.019628f, 0.016172f, 0.0133f, 0.010759f, 0.008542f, 0.006661f, 0.005132f, 0.003982f, 0.003239f, 0.002934f, 0.003114f, 0.003816f, 0.005095f, 0.006936f, 0.009299f, 0.012147f, 0.015444f, 0.019156f, 0.02325f, 0.02769f, 0.032444f, 0.037465f, 0.042956f, 0.049114f, 0.05592f, 0.063349f, 0.071358f, 0.079901f, 0.088909f, 0.098293f, 0.107949f, 0.117749f, 0.127839f, 0.13845f, 0.149516f, 0.161041f, 0.172953f, 0.185209f, 0.197755f, 0.210538f, 0.22346f, 0.236491f, 0.249633f, 0.262972f, 0.276515f, 0.290269f, 0.304213f, 0.318361f, 0.332705f, 0.347232f, 0.361926f, 0.376772f, 0.391683f, 0.406594f, 0.421539f, 0.436517f, 0.451584f, 0.466782f, 0.482147f, 0.497738f, 0.513606f, 0.529826f, 0.54644f, 0.563426f, 0.580726f, 0.59829f, 0.616053f, 0.633948f, 0.651901f, 0.669824f, 0.687632f, 0.705224f, 0.722773f, 0.740483f, 0.758273f, 0.776083f, 0.793832f, 0.811436f, 0.828822f, 0.845879f, 0.862525f, 0.878655f, 0.894208f, 0.909206f, 0.923672f, 0.937638f, 0.951162f, 0.964283f, 0.977068f, 0.98959f, 1.00191f, 1.01416f, 1.0265f, 1.0388f, 1.051f, 1.0629f, 1.0743f, 1.0852f, 1.0952f, 1.1042f, 1.112f, 1.11852f, 1.1238f, 1.128f, 1.1311f, 1.1332f, 1.1343f, 1.1343f, 1.1333f, 1.1312f, 1.1281f, 1.12399f, 1.1189f, 1.1129f, 1.1059f, 1.098f, 1.0891f, 1.0792f, 1.0684f, 1.0567f, 1.044f, 1.03048f, 1.016f, 1.0008f, 0.98479f, 0.96808f, 0.95074f, 0.9328f, 0.91434f, 0.89539f, 0.87603f, 0.856297f, 0.83635f, 0.81629f, 0.79605f, 0.77561f, 0.75493f, 0.73399f, 0.71278f, 0.69129f, 0.66952f, 0.647467f, 0.62511f, 0.60252f, 0.57989f, 0.55737f, 0.53511f, 0.51324f, 0.49186f, 0.47108f, 0.45096f, 0.431567f, 0.41287f, 0.39475f, 0.37721f, 0.36019f, 0.34369f, 0.32769f, 0.31217f, 0.29711f, 0.2825f, 0.268329f, 0.25459f, 0.2413f, 0.22848f, 0.21614f, 0.2043f, 0.19295f, 0.18211f, 0.17177f, 0.16192f, 0.152568f, 0.14367f, 0.1352f, 0.12713f, 0.11948f, 0.11221f, 0.10531f, 0.098786f, 0.09261f, 0.086773f, 0.0812606f, 0.076048f, 0.071114f, 0.066454f, 0.062062f, 0.05793f, 0.05405f, 0.050412f, 0.047006f, 0.043823f, 0.0408508f, 0.038072f, 0.035468f, 0.033031f, 0.030753f, 0.028623f, 0.026635f, 0.024781f, 0.023052f, 0.021441f, 0.0199413f, 0.018544f, 0.017241f, 0.016027f, 0.014896f, 0.013842f, 0.012862f, 0.011949f, 0.0111f, 0.010311f, 0.00957688f, 0.008894f, 0.0082581f, 0.0076664f, 0.0071163f, 0.0066052f, 0.0061306f, 0.0056903f, 0.0052819f, 0.0049033f, 0.00455263f, 0.0042275f, 0.0039258f, 0.0036457f, 0.0033859f, 0.0031447f, 0.0029208f, 0.002713f, 0.0025202f, 0.0023411f, 0.00217496f, 0.0020206f, 0.0018773f, 0.0017441f, 0.0016205f, 0.0015057f, 0.0013992f, 0.0013004f, 0.0012087f, 0.0011236f, 0.00104476f, 0.00097156f, 0.0009036f, 0.00084048f, 0.00078187f, 0.00072745f, 0.0006769f, 0.00062996f, 0.00058637f, 0.00054587f, 0.000508258f, 0.0004733f, 0.0004408f, 0.00041058f, 0.00038249f, 0.00035638f, 0.00033211f, 0.00030955f, 0.00028858f, 0.00026909f, 0.000250969f, 0.00023413f, 0.00021847f, 0.00020391f, 0.00019035f, 0.00017773f, 0.00016597f, 0.00015502f, 0.0001448f, 0.00013528f, 0.00012639f, 0.0001181f, 0.00011037f, 0.00010315f, 0.000096427f, 0.000090151f, 0.000084294f, 0.00007883f, 0.000073729f, 0.000068969f, 6.45258E-05f, 0.000060376f, 0.0000565f, 0.00005288f, 0.000049498f, 0.000046339f, 0.000043389f, 0.000040634f, 0.00003806f, 0.000035657f, 3.34117E-05f, 0.000031315f, 0.000029355f, 0.000027524f, 0.000025811f, 0.000024209f, 0.000022711f, 0.000021308f, 0.000019994f, 0.000018764f, 1.76115E-05f, 0.000016532f, 0.000015521f, 0.000014574f, 0.000013686f, 0.000012855f, 0.000012075f, 0.000011345f, 0.000010659f, 0.000010017f, 9.41363E-06f, 8.8479E-06f, 8.3171E-06f, 0.000007819f, 7.3516E-06f, 0.000006913f, 6.5015E-06f, 6.1153E-06f, 5.7529E-06f, 5.4127E-06f, 5.09347E-06f, 4.7938E-06f, 4.5125E-06f, 4.2483E-06f, 4.0002E-06f, 3.7671E-06f, 0.000003548f, 3.3421E-06f, 3.1485E-06f, 2.9665E-06f, 2.79531E-06f, 2.6345E-06f, 2.4834E-06f, 2.3414E-06f, 2.2078E-06f, 0.000002082f, 1.9636E-06f, 1.8519E-06f, 1.7465E-06f, 1.6471E-06f, 1.55314E-06f };
            /// <summary>
            /// ȳ(λ). 1 nm steps from 360 to 830.
            /// </summary>
            public static readonly float[] Y = { 1.3398E-08f, 2.0294E-08f, 3.056E-08f, 4.574E-08f, 6.805E-08f, 1.0065E-07f, 1.4798E-07f, 2.1627E-07f, 3.142E-07f, 4.537E-07f, 6.511E-07f, 9.288E-07f, 1.3175E-06f, 1.8572E-06f, 0.000002602f, 0.000003625f, 0.000005019f, 0.000006907f, 0.000009449f, 0.000012848f, 0.000017364f, 0.000023327f, 0.00003115f, 0.00004135f, 0.00005456f, 0.00007156f, 0.0000933f, 0.00012087f, 0.00015564f, 0.0001992f, 0.0002534f, 0.0003202f, 0.0004024f, 0.0005023f, 0.0006232f, 0.0007685f, 0.0009417f, 0.0011478f, 0.0013903f, 0.001674f, 0.0020044f, 0.002386f, 0.002822f, 0.003319f, 0.00388f, 0.004509f, 0.005209f, 0.005985f, 0.006833f, 0.007757f, 0.008756f, 0.009816f, 0.010918f, 0.012058f, 0.013237f, 0.014456f, 0.015717f, 0.017025f, 0.018399f, 0.019848f, 0.021391f, 0.022992f, 0.024598f, 0.026213f, 0.027841f, 0.029497f, 0.031195f, 0.032927f, 0.034738f, 0.036654f, 0.038676f, 0.040792f, 0.042946f, 0.045114f, 0.047333f, 0.049602f, 0.051934f, 0.054337f, 0.056822f, 0.059399f, 0.062077f, 0.064737f, 0.067285f, 0.069764f, 0.072218f, 0.074704f, 0.077272f, 0.079979f, 0.082874f, 0.086f, 0.089456f, 0.092947f, 0.096275f, 0.099535f, 0.102829f, 0.106256f, 0.109901f, 0.113835f, 0.118167f, 0.122932f, 0.128201f, 0.133457f, 0.138323f, 0.143042f, 0.147787f, 0.152761f, 0.158102f, 0.163941f, 0.170362f, 0.177425f, 0.18519f, 0.193025f, 0.200313f, 0.207156f, 0.213644f, 0.21994f, 0.22617f, 0.232467f, 0.239025f, 0.245997f, 0.253589f, 0.261876f, 0.270643f, 0.279645f, 0.288694f, 0.297665f, 0.306469f, 0.315035f, 0.323335f, 0.331366f, 0.339133f, 0.34786f, 0.358326f, 0.370001f, 0.382464f, 0.395379f, 0.408482f, 0.421588f, 0.434619f, 0.447601f, 0.460777f, 0.47434f, 0.4882f, 0.50234f, 0.51674f, 0.53136f, 0.54619f, 0.56118f, 0.57629f, 0.5915f, 0.606741f, 0.62215f, 0.63783f, 0.65371f, 0.66968f, 0.68566f, 0.70155f, 0.71723f, 0.73257f, 0.74746f, 0.761757f, 0.77534f, 0.78822f, 0.80046f, 0.81214f, 0.82333f, 0.83412f, 0.8446f, 0.85487f, 0.86504f, 0.875211f, 0.88537f, 0.89537f, 0.90515f, 0.91465f, 0.92381f, 0.93255f, 0.94081f, 0.94852f, 0.9556f, 0.961988f, 0.96754f, 0.97223f, 0.97617f, 0.97946f, 0.9822f, 0.98452f, 0.98652f, 0.98832f, 0.99002f, 0.991761f, 0.99353f, 0.99523f, 0.99677f, 0.99809f, 0.99911f, 0.99977f, 1f, 0.99971f, 0.99885f, 0.99734f, 0.99526f, 0.99274f, 0.98975f, 0.9863f, 0.98238f, 0.97798f, 0.97311f, 0.96774f, 0.96189f, 0.955552f, 0.948601f, 0.940981f, 0.932798f, 0.924158f, 0.915175f, 0.905954f, 0.896608f, 0.887249f, 0.877986f, 0.868934f, 0.860164f, 0.851519f, 0.842963f, 0.834393f, 0.825623f, 0.816764f, 0.807544f, 0.797947f, 0.787893f, 0.777405f, 0.76649f, 0.755309f, 0.743845f, 0.73219f, 0.720353f, 0.708281f, 0.696055f, 0.683621f, 0.671048f, 0.658341f, 0.645545f, 0.632718f, 0.619815f, 0.606887f, 0.593878f, 0.580781f, 0.567653f, 0.55449f, 0.541228f, 0.527963f, 0.514634f, 0.501363f, 0.488124f, 0.474935f, 0.461834f, 0.448823f, 0.435917f, 0.423153f, 0.410526f, 0.398057f, 0.385835f, 0.373951f, 0.362311f, 0.350863f, 0.339554f, 0.328309f, 0.317118f, 0.305936f, 0.294737f, 0.283493f, 0.272222f, 0.26099f, 0.249877f, 0.238946f, 0.228254f, 0.217853f, 0.20778f, 0.198072f, 0.188748f, 0.179828f, 0.171285f, 0.163059f, 0.155151f, 0.147535f, 0.140211f, 0.13317f, 0.1264f, 0.119892f, 0.11364f, 0.107633f, 0.10187f, 0.096347f, 0.091063f, 0.08601f, 0.081187f, 0.076583f, 0.072198f, 0.068024f, 0.064052f, 0.060281f, 0.056697f, 0.053292f, 0.050059f, 0.046998f, 0.044096f, 0.041345f, 0.0387507f, 0.0362978f, 0.0339832f, 0.0318004f, 0.0297395f, 0.0277918f, 0.0259551f, 0.0242263f, 0.0226017f, 0.0210779f, 0.0196505f, 0.0183153f, 0.0170686f, 0.0159051f, 0.0148183f, 0.0138008f, 0.0128495f, 0.0119607f, 0.0111303f, 0.0103555f, 0.0096332f, 0.0089599f, 0.0083324f, 0.0077488f, 0.0072046f, 0.0066975f, 0.0062251f, 0.005785f, 0.0053751f, 0.0049941f, 0.0046392f, 0.0043093f, 0.0040028f, 0.00371774f, 0.00345262f, 0.00320583f, 0.00297623f, 0.00276281f, 0.00256456f, 0.00238048f, 0.00220971f, 0.00205132f, 0.00190449f, 0.00176847f, 0.00164236f, 0.00152535f, 0.00141672f, 0.00131595f, 0.00122239f, 0.00113555f, 0.00105494f, 0.00098014f, 0.00091066f, 0.00084619f, 0.00078629f, 0.00073068f, 0.00067899f, 0.00063101f, 0.00058644f, 0.00054511f, 0.00050672f, 0.00047111f, 0.00043805f, 0.00040741f, 0.000378962f, 0.000352543f, 0.000328001f, 0.000305208f, 0.000284041f, 0.000264375f, 0.000246109f, 0.000229143f, 0.000213376f, 0.00019873f, 0.000185115f, 0.000172454f, 0.000160678f, 0.00014973f, 0.00013955f, 0.000130086f, 0.00012129f, 0.000113106f, 0.000105501f, 0.000098428f, 0.000091853f, 0.000085738f, 0.000080048f, 0.000074751f, 0.000069819f, 0.000065222f, 0.000060939f, 0.000056942f, 0.000053217f, 0.000049737f, 0.000046491f, 0.000043464f, 0.000040635f, 0.000038f, 3.55405E-05f, 3.32448E-05f, 3.11006E-05f, 0.000029099f, 2.72307E-05f, 0.000025486f, 2.38561E-05f, 2.23332E-05f, 2.09104E-05f, 1.95808E-05f, 1.83384E-05f, 1.71777E-05f, 1.60934E-05f, 0.00001508f, 1.41336E-05f, 0.000013249f, 1.24226E-05f, 1.16499E-05f, 1.09277E-05f, 1.02519E-05f, 9.6196E-06f, 9.0281E-06f, 0.000008474f, 7.9548E-06f, 7.4686E-06f, 7.0128E-06f, 6.5858E-06f, 6.1857E-06f, 5.8107E-06f, 0.000005459f, 5.1298E-06f, 4.8206E-06f, 4.5312E-06f, 4.2591E-06f, 4.0042E-06f, 3.76473E-06f, 3.53995E-06f, 3.32914E-06f, 3.13115E-06f, 2.94529E-06f, 2.77081E-06f, 2.60705E-06f, 2.45329E-06f, 2.30894E-06f, 2.17338E-06f, 2.04613E-06f, 1.92662E-06f, 1.8144E-06f, 1.70895E-06f, 1.60988E-06f, 1.51677E-06f, 1.42921E-06f, 1.34686E-06f, 1.26945E-06f, 1.19662E-06f, 1.12809E-06f, 1.06368E-06f, 1.00313E-06f, 9.4622E-07f, 8.9263E-07f, 8.4216E-07f, 7.9464E-07f, 7.4978E-07f, 7.0744E-07f, 6.6748E-07f, 6.297E-07f };
            /// <summary>
            /// z̄(λ). 1 nm steps from 360 to 830.
            /// </summary>
            public static readonly float[] Z = { 5.35027E-07f, 8.1072E-07f, 1.2212E-06f, 1.8287E-06f, 2.7222E-06f, 4.0283E-06f, 5.9257E-06f, 8.6651E-06f, 0.000012596f, 0.000018201f, 2.61437E-05f, 0.00003733f, 0.000052987f, 0.000074764f, 0.00010487f, 0.00014622f, 0.00020266f, 0.00027923f, 0.00038245f, 0.00052072f, 0.000704776f, 0.00094823f, 0.0012682f, 0.0016861f, 0.0022285f, 0.0029278f, 0.0038237f, 0.0049642f, 0.0064067f, 0.0082193f, 0.0104822f, 0.013289f, 0.016747f, 0.02098f, 0.026127f, 0.032344f, 0.039802f, 0.048691f, 0.05921f, 0.071576f, 0.0860109f, 0.10274f, 0.122f, 0.14402f, 0.16899f, 0.19712f, 0.22857f, 0.26347f, 0.3019f, 0.34387f, 0.389366f, 0.43797f, 0.48922f, 0.5429f, 0.59881f, 0.65676f, 0.71658f, 0.77812f, 0.84131f, 0.90611f, 0.972542f, 1.0389f, 1.1031f, 1.1651f, 1.2249f, 1.2825f, 1.3382f, 1.3926f, 1.4461f, 1.4994f, 1.55348f, 1.6072f, 1.6589f, 1.7082f, 1.7548f, 1.7985f, 1.8392f, 1.8766f, 1.9105f, 1.9408f, 1.96728f, 1.9891f, 2.0057f, 2.0174f, 2.0244f, 2.0273f, 2.0264f, 2.0223f, 2.0153f, 2.006f, 1.9948f, 1.9814f, 1.9653f, 1.9464f, 1.9248f, 1.9007f, 1.8741f, 1.8451f, 1.8139f, 1.7806f, 1.74537f, 1.7091f, 1.6723f, 1.6347f, 1.5956f, 1.5549f, 1.5122f, 1.4673f, 1.4199f, 1.37f, 1.31756f, 1.2624f, 1.205f, 1.1466f, 1.088f, 1.0302f, 0.97383f, 0.91943f, 0.86746f, 0.81828f, 0.772125f, 0.72829f, 0.68604f, 0.64553f, 0.60685f, 0.57006f, 0.53522f, 0.50234f, 0.4714f, 0.44239f, 0.415254f, 0.390024f, 0.366399f, 0.344015f, 0.322689f, 0.302356f, 0.283036f, 0.264816f, 0.247848f, 0.232318f, 0.218502f, 0.205851f, 0.193596f, 0.181736f, 0.170281f, 0.159249f, 0.148673f, 0.138609f, 0.129096f, 0.120215f, 0.112044f, 0.10471f, 0.098196f, 0.092361f, 0.087088f, 0.082248f, 0.077744f, 0.073456f, 0.069268f, 0.06506f, 0.060709f, 0.056457f, 0.052609f, 0.049122f, 0.045954f, 0.04305f, 0.040368f, 0.037839f, 0.035384f, 0.032949f, 0.030451f, 0.028029f, 0.025862f, 0.02392f, 0.022174f, 0.020584f, 0.019127f, 0.01774f, 0.016403f, 0.015064f, 0.013676f, 0.012308f, 0.011056f, 0.009915f, 0.008872f, 0.007918f, 0.00703f, 0.006223f, 0.005453f, 0.004714f, 0.003988f, 0.003289f, 0.002646f, 0.002063f, 0.001533f, 0.001091f, 0.000711f, 0.000407f, 0.000184f, 0.000047f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f };
        }

        /// <summary>
        /// Stiles & Burch (1955) 2-deg colour matching functions.
        /// </summary>
        /// <remarks>
        /// The Stiles & Burch 2-deg CMFs are based on measurements made in 10 observers.
        /// The data are referred to as pilot data, but probably represent the best estimate of the 2 deg CMFs, since, unlike the CIE 2 deg functions (which were reconstructed from chromaticity data), they were measured directly.
        /// From Table I (5.5.3) of Wyszecki & Stiles (1982). (Table 1 (5.5.3) of Wyszecki & Stiles (1982) gives the Stiles & Burch functions in 250 cm<sup>-1</sup> steps, while Table I (5.5.3) of Wyszecki & Stiles (1982) is gives them in interpolated 1 nm steps.)
        /// These CMFs differ slightly from those of Stiles & Burch (1955). As noted in footnote a on p. 335 of Table 1 (5.5.3) of Wyszecki & Stiles (1982), the CMFs have been "corrected in accordance with instructions given by Stiles & Burch (1959)" and renormalized to primaries at 15500 (645.16), 19000 (526.32), and 22500 (444.44) cm<sup>-1</sup> (nm). 
        /// </remarks>
        private static class StilesBurch1955RGB
        {
            public const int Degrees = 2;
            public const int StepNanometers = 5;
            public const int FirstNanometers = 390;
            public const int LastNanometers = 730;

            /// <summary>
            /// r̄(λ). 5 nm steps from 390 to 730.
            /// </summary>
            public static readonly float[] R = { 0.0018397f, 0.0046153f, 0.0096264f, 0.018979f, 0.030803f, 0.042459f, 0.051662f, 0.052837f, 0.044287f, 0.03222f, 0.014763f, -0.0023392f, -0.02913f, -0.060677f, -0.096224f, -0.13759f, -0.17486f, -0.2126f, -0.2378f, -0.25674f, -0.27727f, -0.29125f, -0.295f, -0.29706f, -0.26759f, -0.21725f, -0.14768f, -0.035184f, 0.10614f, 0.25981f, 0.41976f, 0.59259f, 0.79004f, 1.0078f, 1.2283f, 1.4727f, 1.7476f, 2.0214f, 2.2724f, 2.4896f, 2.6725f, 2.8093f, 2.8717f, 2.8525f, 2.7601f, 2.5989f, 2.3743f, 2.1054f, 1.8145f, 1.5247f, 1.2543f, 1.0076f, 0.78642f, 0.59659f, 0.4432f, 0.3241f, 0.23455f, 0.16884f, 0.12086f, 0.085811f, 0.06026f, 0.04148f, 0.028114f, 0.019117f, 0.013305f, 0.0094092f, 0.0065177f, 0.0045377f, 0.0031742f };
            /// <summary>
            /// ḡ(λ). 5 nm steps from 390 to 730.
            /// </summary>
            public static readonly float[] G = { -0.00045393f, -0.0010464f, -0.0021689f, -0.0044304f, -0.0072048f, -0.012579f, -0.016651f, -0.02124f, -0.019936f, -0.016097f, -0.0073457f, 0.001369f, 0.01961f, 0.043464f, 0.070954f, 0.11022f, 0.15088f, 0.19794f, 0.24042f, 0.27993f, 0.33353f, 0.40521f, 0.4906f, 0.59673f, 0.70184f, 0.80852f, 0.91076f, 0.98482f, 1.0339f, 1.0538f, 1.0512f, 1.0498f, 1.0368f, 0.99826f, 0.93783f, 0.88039f, 0.82835f, 0.74686f, 0.6493f, 0.56317f, 0.47675f, 0.38484f, 0.30069f, 0.22853f, 0.16575f, 0.11373f, 0.074682f, 0.046504f, 0.026333f, 0.012724f, 0.0045033f, 0.000096611f, -0.0019645f, -0.0026327f, -0.0026262f, -0.0023027f, -0.00187f, -0.0014424f, -0.0010755f, -0.00079004f, -0.00056765f, -0.00039274f, -0.00026231f, -0.00017512f, -0.0001214f, -0.00008576f, -0.000057677f, -0.000039003f, -0.000026511f };
            /// <summary>
            /// b̄(λ). 5 nm steps from 390 to 730.
            /// </summary>
            public static readonly float[] B = { 0.012152f, 0.03111f, 0.062371f, 0.13161f, 0.2275f, 0.35897f, 0.52396f, 0.68586f, 0.79604f, 0.89459f, 0.96395f, 0.99814f, 0.91875f, 0.82487f, 0.78554f, 0.66723f, 0.61098f, 0.48829f, 0.36195f, 0.26634f, 0.19593f, 0.1473f, 0.10749f, 0.076714f, 0.050248f, 0.028781f, 0.013309f, 0.002117f, -0.0041574f, -0.0083032f, -0.012191f, -0.014039f, -0.014681f, -0.014947f, -0.014613f, -0.013782f, -0.01265f, -0.011356f, -0.0099317f, -0.0084148f, -0.007021f, -0.0057437f, -0.0042743f, -0.0029132f, -0.0022693f, -0.0019966f, -0.0015069f, -0.00093822f, -0.00055316f, -0.00031668f, -0.00014319f, -4.0831E-06f, 0.00011081f, 0.00019175f, 0.00022656f, 0.0002152f, 0.00016361f, 0.000097164f, 0.000051033f, 0.000035271f, 0.000031211f, 0.000024508f, 0.000016521f, 0.000011124f, 8.6965E-06f, 7.4351E-06f, 6.1057E-06f, 5.0277E-06f, 4.1251E-06f };
        }

        /// <summary>
        /// Stiles & Burch (1959) 10-deg colour matching functions.
        /// </summary>
        /// <remarks>
        /// Mean 10-deg colour matching functions of Stiles and Burch (1959).
        /// Primaries at 15500 (645.16), 19000 (526.32) and 22500 (444.44) cm<sup>-1</sup> (nm). 
        /// At shorter wavelengths from Table I (5.5.4); but, at longer wavelengths, corrected by Stockman and Sharpe (2000) from the original CMFs (Table 7 of Stiles & Burch, 1959) for rod intrusion (according to the corrections given in Table 8 of Stiles & Burch, 1959) and re-interpolated at 5-nm intervals.
        /// See Table 3 of Stockman and Sharpe (2000). 
        /// The 10-deg CMFs of Stiles and Burch, like their 2-deg functions, have the advantage over the CIE 2-deg functions in that they were measured directly and thus do not depend on unnecessary photometric assumptions.
        /// The 10-deg CMFs reflect a lower macular pigment density than the 2-deg functions, since macular pigmentation declines with eccentricity.
        /// They also reflect a narrowing of the underlying cone spectral sensitivities, since cone outersegments become shorter with increasing eccentricity, thus reducing the axial optical pigment density in the cone outer segment. 
        /// </remarks>
        private static class StilesBurch1959RGB
        {
            public const int Degrees = 10;
            public const int StepNanometers = 5;
            public const int FirstNanometers = 390;
            public const int LastNanometers = 830;

            /// <summary>
            /// r̄<sub>10</sub>10(λ). 5 nm steps from 390 to 830.
            /// </summary>
            public static readonly float[] R = { 0.0015f, 0.0038f, 0.0089f, 0.0188f, 0.035f, 0.0531f, 0.0702f, 0.0763f, 0.0745f, 0.0561f, 0.0323f, -0.0044f, -0.0478f, -0.097f, -0.1586f, -0.2235f, -0.2848f, -0.3346f, -0.3776f, -0.4136f, -0.4317f, -0.4452f, -0.435f, -0.414f, -0.3673f, -0.2845f, -0.1855f, -0.0435f, 0.127f, 0.3129f, 0.5362f, 0.7722f, 1.0059f, 1.271f, 1.5574f, 1.8465f, 2.1511f, 2.425f, 2.6574f, 2.9151f, 3.0779f, 3.1613f, 3.1673f, 3.1048f, 2.9462f, 2.7194f, 2.4526f, 2.17f, 1.8358f, 1.5179f, 1.2428f, 1.007f, 0.7827f, 0.5934f, 0.4442f, 0.3283f, 0.2394f, 0.1722f, 0.1221f, 0.0853f, 0.0586f, 0.0408f, 0.0284f, 0.0197f, 0.0135f, 0.00924f, 0.00638f, 0.00441f, 0.00307f, 0.00214f, 0.00149f, 0.00105f, 0.000739f, 0.000523f, 0.000372f, 0.000265f, 0.00019f, 0.000136f, 0.0000984f, 0.0000713f, 0.0000518f, 0.0000377f, 0.0000276f, 0.0000203f, 0.0000149f, 0.000011f, 0.00000818f, 0.00000609f, 0.00000455f };
            /// <summary>
            /// ḡ<sub>10</sub>10(λ). 5 nm steps from 390 to 830.
            /// </summary>
            public static readonly float[] G = { -0.0004f, -0.001f, -0.0025f, -0.0059f, -0.0119f, -0.0201f, -0.0289f, -0.0338f, -0.0349f, -0.0276f, -0.0169f, 0.0024f, 0.0283f, 0.0636f, 0.1082f, 0.1617f, 0.2201f, 0.2796f, 0.3428f, 0.4086f, 0.4716f, 0.5491f, 0.626f, 0.7097f, 0.7935f, 0.8715f, 0.9477f, 0.9945f, 1.0203f, 1.0375f, 1.0517f, 1.039f, 1.0029f, 0.9698f, 0.9162f, 0.8571f, 0.7823f, 0.6953f, 0.5966f, 0.5063f, 0.4203f, 0.336f, 0.2591f, 0.1917f, 0.1367f, 0.0938f, 0.0611f, 0.0371f, 0.0215f, 0.0112f, 0.0044f, 0.000078f, -0.001368f, -0.001988f, -0.002168f, -0.002006f, -0.001642f, -0.001272f, -0.000947f, -0.000683f, -0.000478f, -0.000337f, -0.000235f, -0.000163f, -0.000111f, -0.0000748f, -0.0000508f, -0.0000344f, -0.0000234f, -0.0000159f, -0.0000107f, -0.00000723f, -0.00000487f, -0.00000329f, -0.00000222f, -0.0000015f, -0.00000102f, -0.000000688f, -0.000000465f, -0.000000312f, -0.000000208f, -0.000000137f, -0.000000088f, -5.53E-08f, -3.36E-08f, -1.96E-08f, -1.09E-08f, -5.7E-09f, -2.77E-09f };
            /// <summary>
            /// b̄<sub>10</sub>(λ). 5 nm steps from 390 to 830.
            /// </summary>
            public static readonly float[] B = { 0.0062f, 0.0161f, 0.04f, 0.0906f, 0.1802f, 0.3088f, 0.467f, 0.6152f, 0.7638f, 0.8778f, 0.9755f, 1.0019f, 0.9996f, 0.9139f, 0.8297f, 0.7417f, 0.6134f, 0.472f, 0.3495f, 0.2564f, 0.1819f, 0.1307f, 0.091f, 0.058f, 0.0357f, 0.02f, 0.0095f, 0.0007f, -0.0043f, -0.0064f, -0.0082f, -0.0094f, -0.0097f, -0.0097f, -0.0093f, -0.0087f, -0.008f, -0.0073f, -0.0063f, -0.00537f, -0.00445f, -0.00357f, -0.00277f, -0.00208f, -0.0015f, -0.00103f, -0.00068f, -0.000442f, -0.000272f, -0.000141f, -0.0000549f, -0.0000022f, 0.0000237f, 0.0000286f, 0.0000261f, 0.0000225f, 0.0000182f, 0.0000139f, 0.0000103f, 0.00000738f, 0.00000522f, 0.00000367f, 0.00000256f, 0.00000176f, 0.0000012f, 0.000000817f, 0.000000555f, 0.000000375f, 0.000000254f, 0.000000171f, 0.000000116f, 7.85E-08f, 5.31E-08f, 0.000000036f, 2.44E-08f, 1.65E-08f, 1.12E-08f, 7.53E-09f, 5.07E-09f, 3.4E-09f, 2.27E-09f, 1.5E-09f, 9.86E-10f, 6.39E-10f, 4.07E-10f, 2.53E-10f, 1.52E-10f, 8.64E-11f, 4.42E-11f };
        }



        private static Lazy<_StockmanLMStoXYZ_L5nmRight> _stockmanL5R = new Lazy<_StockmanLMStoXYZ_L5nmRight>(isThreadSafe: false);
        public static XYZ StockmanL5R => _stockmanL5R.Value;

        private static Lazy<_StockmanLMStoXYZ_L5nmLeft> _stockmanL5L = new Lazy<_StockmanLMStoXYZ_L5nmLeft>(isThreadSafe: false);
        public static XYZ StockmanL5L => _stockmanL5L.Value;


        private static class Stockman2006LMS
        {
            public const int Degrees = 10;
            public const int StepNanometers = 5;
            public const int FirstNanometers = 390;
            public const int LastNanometers = 830;

            public static readonly float[] L = { 0.000407619f, 0.00106921f, 0.00254073f, 0.00531546f, 0.00998835f, 0.016013f, 0.0233957f, 0.0309104f, 0.039781f, 0.0494172f, 0.0594619f, 0.0686538f, 0.0795647f, 0.0907704f, 0.106663f, 0.128336f, 0.151651f, 0.177116f, 0.20794f, 0.244046f, 0.282752f, 0.334786f, 0.391705f, 0.456252f, 0.526538f, 0.599867f, 0.675313f, 0.737108f, 0.7889f, 0.837403f, 0.890871f, 0.92666f, 0.944527f, 0.970703f, 0.985636f, 0.996979f, 0.999543f, 0.987057f, 0.957841f, 0.939781f, 0.906693f, 0.859605f, 0.803173f, 0.74068f, 0.668991f, 0.593248f, 0.517449f, 0.445125f, 0.369168f, 0.300316f, 0.242316f, 0.19373f, 0.149509f, 0.112638f, 0.0838077f, 0.0616384f, 0.0448132f, 0.032166f, 0.0227738f, 0.0158939f, 0.0109123f, 0.00759453f, 0.00528607f, 0.00366675f, 0.00251327f, 0.00172108f, 0.001189f, 0.000822396f, 0.000572917f, 0.00039967f, 0.000278553f, 0.000196528f, 0.000138482f, 9.81226E-05f, 6.98827E-05f, 0.000049843f, 3.57781E-05f, 2.56411E-05f, 1.85766E-05f, 1.34792E-05f, 9.80671E-06f, 7.14808E-06f, 5.24229E-06f, 3.8628E-06f, 2.84049E-06f, 2.10091E-06f, 1.56506E-06f, 0.000001167f, 8.73008E-07f };
            public static readonly float[] M = { 0.000358227f, 0.000964828f, 0.00237208f, 0.00512316f, 0.00998841f, 0.0172596f, 0.0273163f, 0.0396928f, 0.0555384f, 0.0750299f, 0.0957612f, 0.11622f, 0.139493f, 0.162006f, 0.193202f, 0.232275f, 0.271441f, 0.310372f, 0.355066f, 0.405688f, 0.456137f, 0.52297f, 0.591003f, 0.666404f, 0.743612f, 0.816808f, 0.889214f, 0.934977f, 0.961962f, 0.981481f, 0.998931f, 0.991383f, 0.961876f, 0.935829f, 0.890949f, 0.840969f, 0.776526f, 0.700013f, 0.611728f, 0.531825f, 0.454142f, 0.376527f, 0.304378f, 0.239837f, 0.185104f, 0.140431f, 0.104573f, 0.0765841f, 0.055499f, 0.0397097f, 0.0280314f, 0.0194366f, 0.013766f, 0.00954315f, 0.00650455f, 0.00442794f, 0.0030605f, 0.00211596f, 0.00145798f, 0.000998424f, 0.000677653f, 0.00046787f, 0.000325278f, 0.000225641f, 0.000155286f, 0.000107388f, 7.49453E-05f, 5.24748E-05f, 3.70443E-05f, 2.62088E-05f, 1.85965E-05f, 1.33965E-05f, 9.63397E-06f, 6.96522E-06f, 5.06711E-06f, 3.68617E-06f, 2.69504E-06f, 1.96864E-06f, 1.45518E-06f, 1.07784E-06f, 8.00606E-07f, 5.96195E-07f, 4.4803E-07f, 3.38387E-07f, 2.54942E-07f, 1.93105E-07f, 1.47054E-07f, 1.11751E-07f, 8.48902E-08f };
            public static readonly float[] S = { 0.00614265f, 0.0159515f, 0.0396308f, 0.0897612f, 0.17853f, 0.305941f, 0.462692f, 0.60957f, 0.756885f, 0.869984f, 0.96696f, 0.993336f, 0.991329f, 0.906735f, 0.823726f, 0.737043f, 0.610456f, 0.470894f, 0.350108f, 0.258497f, 0.185297f, 0.135351f, 0.096799f, 0.0649614f, 0.0412337f, 0.02713f, 0.0176298f, 0.0113252f, 0.00717089f, 0.00454287f, 0.00283352f, 0.00175573f, 0.0010823f, 0.000664512f, 0.000408931f, 0.000251918f, 0.000155688f, 9.67045E-05f, 6.04705E-05f, 3.81202E-05f, 2.42549E-05f, 1.55924E-05f, 1.01356E-05f, 6.66657E-06f, 4.43906E-06f, 2.99354E-06f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f };
        }

        private class _StockmanLMStoXYZ_L5nmRight : _StockmanLMStoXYZ
        {
            public _StockmanLMStoXYZ_L5nmRight() : base(-1) { }
        }
        private class _StockmanLMStoXYZ_L5nmLeft : _StockmanLMStoXYZ
        {
            public _StockmanLMStoXYZ_L5nmLeft() : base(1) { }
        }
        private class _StockmanLMStoXYZ : XYZ
        {            
            public override int FirstNanometers => Stockman2006LMS.FirstNanometers;
            public override int LastNanometers => Stockman2006LMS.LastNanometers;
            public override int StepNanometers => Stockman2006LMS.StepNanometers;

            private readonly int ShiftL;
            public _StockmanLMStoXYZ(int shiftL) => ShiftL = shiftL;

            private float[] _samplesX;
            private float[] _samplesY;
            private float[] _samplesZ;

            protected override float[] SamplesX => EnsureSamples(ref _samplesX);

            private float[] EnsureSamples(ref float[] samples)
            {
                if (samples != null)
                    return samples;

                int length = (LastNanometers - FirstNanometers) / StepNanometers + 1;
                _samplesX = new float[length];
                _samplesY = new float[length];
                _samplesZ = new float[length];
                for (int i = 0; i < length; i++)
                    LMStoXYZ(Stockman2006LMS.L[Math.Max(0, Math.Min(length - 1, i - ShiftL))], Stockman2006LMS.M[i], Stockman2006LMS.S[i], out _samplesX[i], out _samplesY[i], out _samplesZ[i]);

                return samples;
            }

            protected override float[] SamplesY => EnsureSamples(ref _samplesY);
            protected override float[] SamplesZ => EnsureSamples(ref _samplesZ);

            //TODO: CovnertColor.ToXYZ(LMS, matrix)
            private static void LMStoXYZ(float l10, float m10, float s10, out float x10, out float y10, out float z10)
            {
                x10 = 1.93986443f * l10 - 1.34664359f * m10 + 0.43044935f * s10;
                y10 = 0.69283932f * l10 + 0.34967567f * m10;
                z10 = 2.14687945f * s10;
            }
        }

        // CIE. (1926). Commission Internationale de l’Éclairage Proceedings, 1924. Cambridge: Cambridge University Press.
        // Wright, W. D. (1928). A re-determination of the trichromatic coefficients of the spectral colours. Transactions of the Optical Society, 30, 141-164.
        // Guild, J. (1931). The colorimetric properties of the spectrum. Philosophical Transactions of the Royal Society of London, A230, 149-187.
        // CIE. (1932). Commission Internationale de l’Éclairage Proceedings, 1931. Cambridge: Cambridge University Press.
        // Judd, D. B. (1951). Report of U.S. Secretariat Committee on Colorimetry and Artificial Daylight. In Proceedings of the Twelfth Session of the CIE, Stockholm (vol. 1, pp. 11). Paris: Bureau Central de la CIE.
        // Brindley, G. S. (1955). The colour of light of very long wavelength. Journal of Physiology, 130, 35-44.
        // Speranskaya, N. I. (1959). Determination of spectrum color co-ordinates for twenty-seven normal observers. Optics and Spectroscopy, 7, 424-428.
        // CIE Proceedings (1964) Vienna Session, 1963, Vol. B, pp. 209-220 (Committee Report E-1.4.1), Bureau Central de la CIE, Paris
        // Vos, J. J. (1978). Colorimetric and photometric properties of a 2-deg fundamental observer. Color Research and Application, 3, 125-128.
        // Stiles, W. S., & Burch, J. M. (1955). Interim report to the Commission Internationale de l'Éclairage Zurich, 1955, on the National Physical Laboratory's investigation of colour-matching (1955) with an appendix by W. S. Stiles & J. M. Burch. Optica Acta, 2, 168-181.
        // Stiles, W. S., & Burch, J. M. (1959). NPL colour-matching investigation: Final report. Optica Acta, 6, 1-26.
        // Wyszecki, G., & Stiles, W. S. (1982). Color Science: concepts and methods, quantitative data and formulae. (2nd ed.). New York: Wiley.
        // Stockman, A., & Sharpe, L. T. (2000). Spectral sensitivities of the middle- and long-wavelength sensitive cones derived from measurements in observers of known genotype. Vision Research, 40, 1711-1737.
    }
}
